
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelos de regresión &#8212; EDA PROYECTO FINAL</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modelos';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Propuesta de modelo original" href="original.html" />
    <link rel="prev" title="Análisis Exploratorio de Datos (EDA)" href="eda.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpeg" class="logo__image only-light" alt="EDA PROYECTO FINAL - Home"/>
    <script>document.write(`<img src="_static/logo.jpeg" class="logo__image only-dark" alt="EDA PROYECTO FINAL - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Contextualización del Proyecto
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="eda.html"><strong>Análisis Exploratorio de Datos (EDA)</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Modelos de regresión</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="original.html"><strong>Propuesta de modelo original</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kmarcela11/ProyectoFinal_EnergiaEolica" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kmarcela11/ProyectoFinal_EnergiaEolica/issues/new?title=Issue%20on%20page%20%2Fmodelos.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/modelos.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelos de regresión</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos"><strong>Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracteristicas-principales-de-la-base-de-datos"><strong>Características principales de la base de datos</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>Modelos</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-realizar-las-graficas"><strong>Métodos para realizar las gráficas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-los-modelos-de-regresion"><strong>Métodos para los modelos de regresión</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-1-wind-speed-100-metros-sensor-1"><strong>Modelo 1: Wind speed 100 metros (Sensor 1)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-2-wind-speed-100-metros-sensor-2"><strong>Modelo 2: Wind speed 100 metros (Sensor 2)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-3-wind-speed-80-metros-sensor-1"><strong>Modelo 3: Wind speed 80 metros (Sensor 1)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-4-wind-speed-80-metros-sensor-2"><strong>Modelo 4: Wind speed 80 metros (Sensor 2)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-5-wind-speed-60-metros"><strong>Modelo 5: Wind speed 60 metros</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general"><strong>Conclusión general</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelos-de-regresion">
<h1><strong>Modelos de regresión</strong><a class="headerlink" href="#modelos-de-regresion" title="Link to this heading">#</a></h1>
<p>En esta parte del proyecto, se desarrollan y analizan diversos modelos de regresión con el objetivo de evaluar la influencia de variables meteorológicas —como la dirección del viento, la temperatura, la presión y la humedad— en la velocidad del viento. Para abordar este problema, se han implementado y evaluado diferentes enfoques de aprendizaje automático, comparando su capacidad predictiva y eficiencia en la modelación de las relaciones complejas entre estas variables.</p>
<section id="librerias-y-modulos-necesarios">
<h2><strong>Librerías y modulos necesarios</strong><a class="headerlink" href="#librerias-y-modulos-necesarios" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="datos">
<h2><strong>Datos</strong><a class="headerlink" href="#datos" title="Link to this heading">#</a></h2>
<p>Inicialmente importamos el conjunto de datos que utilizaremos para el desarrollo de los modelos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\kamac\OneDrive\Desktop\MachineLearningUN\EDA\ws_modelos.xlsx&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="caracteristicas-principales-de-la-base-de-datos">
<h3><strong>Características principales de la base de datos</strong><a class="headerlink" href="#caracteristicas-principales-de-la-base-de-datos" title="Link to this heading">#</a></h3>
<p>Aquí podemos ver las primeras cinco filas de nuestro dataset, que será utilizado para la construcción de los modelos de regresión lineal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fecha</th>
      <th>VelViento100m_1</th>
      <th>VelViento100m_2</th>
      <th>VelViento80m_1</th>
      <th>VelViento80m_2</th>
      <th>VelViento60m</th>
      <th>DirViento60m</th>
      <th>DirViento100m</th>
      <th>DirViento80m</th>
      <th>Presion</th>
      <th>Humedad</th>
      <th>Temp100m</th>
      <th>Temp21m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-01-01 00:00:00</td>
      <td>16.060860</td>
      <td>15.830104</td>
      <td>15.145418</td>
      <td>15.125038</td>
      <td>14.300989</td>
      <td>61.98</td>
      <td>61.08</td>
      <td>61.21</td>
      <td>1005.963541</td>
      <td>75.042725</td>
      <td>26.922913</td>
      <td>26.707773</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-01-01 00:10:00</td>
      <td>16.156927</td>
      <td>15.972642</td>
      <td>15.290614</td>
      <td>15.352352</td>
      <td>14.533556</td>
      <td>62.29</td>
      <td>61.08</td>
      <td>61.49</td>
      <td>1005.795867</td>
      <td>73.509216</td>
      <td>27.006836</td>
      <td>26.772633</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-01-01 00:20:00</td>
      <td>16.473571</td>
      <td>16.287375</td>
      <td>15.599149</td>
      <td>15.562022</td>
      <td>14.808378</td>
      <td>61.18</td>
      <td>60.42</td>
      <td>60.65</td>
      <td>1005.739976</td>
      <td>72.914124</td>
      <td>26.991577</td>
      <td>26.772633</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-01-01 00:30:00</td>
      <td>16.660009</td>
      <td>16.451707</td>
      <td>15.801446</td>
      <td>15.779687</td>
      <td>15.170287</td>
      <td>62.20</td>
      <td>60.88</td>
      <td>61.19</td>
      <td>1005.684085</td>
      <td>73.165894</td>
      <td>26.877136</td>
      <td>26.659982</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-01-01 00:40:00</td>
      <td>16.519613</td>
      <td>16.353678</td>
      <td>15.851963</td>
      <td>15.749131</td>
      <td>14.927282</td>
      <td>61.26</td>
      <td>59.99</td>
      <td>60.26</td>
      <td>1005.609563</td>
      <td>73.791504</td>
      <td>26.770325</td>
      <td>26.601949</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(19083, 13)
</pre></div>
</div>
</div>
</div>
<p>El conjunto de datos cuenta con <strong>13</strong> variables y <strong>19083</strong> observaciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VelViento100m_1</th>
      <th>VelViento100m_2</th>
      <th>VelViento80m_1</th>
      <th>VelViento80m_2</th>
      <th>VelViento60m</th>
      <th>DirViento60m</th>
      <th>DirViento100m</th>
      <th>DirViento80m</th>
      <th>Presion</th>
      <th>Humedad</th>
      <th>Temp100m</th>
      <th>Temp21m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
      <td>19083.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>12.312852</td>
      <td>12.178773</td>
      <td>11.935864</td>
      <td>11.932547</td>
      <td>11.607971</td>
      <td>67.265740</td>
      <td>65.990962</td>
      <td>66.286775</td>
      <td>1006.202742</td>
      <td>84.492969</td>
      <td>26.273377</td>
      <td>26.493438</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.451743</td>
      <td>4.403151</td>
      <td>4.286567</td>
      <td>4.276207</td>
      <td>4.121395</td>
      <td>48.492877</td>
      <td>48.712525</td>
      <td>48.584865</td>
      <td>1.823561</td>
      <td>4.303362</td>
      <td>0.846383</td>
      <td>0.951527</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.532543</td>
      <td>0.500556</td>
      <td>0.500413</td>
      <td>0.504115</td>
      <td>0.292860</td>
      <td>0.230000</td>
      <td>0.000000</td>
      <td>0.030000</td>
      <td>1001.417712</td>
      <td>63.072205</td>
      <td>23.710938</td>
      <td>22.700129</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>9.794922</td>
      <td>9.695314</td>
      <td>9.577789</td>
      <td>9.588132</td>
      <td>9.416717</td>
      <td>48.860000</td>
      <td>47.860000</td>
      <td>47.910000</td>
      <td>1004.901606</td>
      <td>81.642151</td>
      <td>25.709839</td>
      <td>25.823634</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>12.941995</td>
      <td>12.808712</td>
      <td>12.555704</td>
      <td>12.558730</td>
      <td>12.223383</td>
      <td>56.480000</td>
      <td>55.300000</td>
      <td>55.580000</td>
      <td>1006.112585</td>
      <td>84.640503</td>
      <td>26.068420</td>
      <td>26.328856</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>15.559608</td>
      <td>15.380787</td>
      <td>15.031122</td>
      <td>15.017974</td>
      <td>14.560523</td>
      <td>64.440000</td>
      <td>63.005000</td>
      <td>63.390000</td>
      <td>1007.435347</td>
      <td>87.669373</td>
      <td>26.587219</td>
      <td>26.997935</td>
    </tr>
    <tr>
      <th>max</th>
      <td>22.301553</td>
      <td>22.027242</td>
      <td>21.730798</td>
      <td>21.769775</td>
      <td>21.140790</td>
      <td>359.900000</td>
      <td>359.950000</td>
      <td>359.890000</td>
      <td>1012.428307</td>
      <td>94.093323</td>
      <td>33.903809</td>
      <td>34.596755</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A partir del análisis estadístico de las variables presentadas en el resumen descriptivo, se puede observar que no hay valores erróneos en los datos de velocidad del viento, presión atmosférica, humedad relativa, temperatura y dirección del viento. Esto se debe a que se han aplicado previamente criterios específicos de limpieza para garantizar la calidad de la base de datos.</p>
<p>Para identificar y eliminar los datos erróneos, se emplearon las siguientes reglas: en la <strong>velocidad del viento</strong>, cualquier valor menor a 0.5 m/s que permanezca fijo en el tiempo se considera un error. Para la <strong>presión atmosférica</strong>, valores por debajo de 980 hPa se identifican como erróneos. En el caso de la <strong>humedad relativa</strong>, valores menores a 60% son inválidos, y para la <strong>temperatura</strong>, cualquier valor inferior a 20°C también es considerado un error, con la particularidad de que los errores en humedad y temperatura suelen coincidir en el tiempo.</p>
<p>Por otro lado, la <strong>dirección del viento</strong> presenta desafíos adicionales en su evaluación, ya que es una variable circular en la que 360° equivale a 0°. Por lo tanto, valores altos no son necesariamente erróneos ni atípicos; en su lugar, los errores en esta variable se detectan cuando la serie permanece fija en un valor específico de manera prolongada.</p>
<p>Con estos filtros aplicados, los valores descriptivos en el resumen indican que la base de datos está limpia y lista para desarrollar y aplicar modelos de regresión para cada una de las variables de velocidad del viento a diferentes alturas.</p>
</section>
</section>
<section id="modelos">
<h2><strong>Modelos</strong><a class="headerlink" href="#modelos" title="Link to this heading">#</a></h2>
<p>Ahora, veamos los modelos. Dado que nuestro objetivo es predecir la velocidad del viento, y encontramos varias variables objetivo (específicamente 5), que corresponden a las velocidades del viento medidas a diferentes alturas y con diferentes sensores, aplicaremos los 8 modelos de regresión seleccionados: Regresión K-NN, Regresión Ridge, Regresión Lasso, Regresión Lineal, Árboles de decisión para regresión, Random Forest, XGboost Y SVR  para cada una de las variables objetivo identificadas.</p>
<p>Para evaluar el desempeño de los modelos, utilizaremos varias métricas, entre ellas el Mean Absolute Percentage Error (MAPE), que nos permitirá medir el error porcentual promedio entre los valores predichos y los valores reales. Esto es especialmente útil cuando se trata de comparaciones de modelos de predicción, ya que el MAPE es intuitivo y fácil de interpretar.</p>
<p>El código para calcular el MAPE se presenta a continuación:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MAPE</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="c1"># Convertimos las entradas a arrays de numpy para facilitar el cálculo vectorizado</span>
    <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Evitar la división por cero, ignorando los valores donde y_true es 0</span>
    <span class="c1"># Creamos un filtro para seleccionar solo los índices donde y_true no sea igual a 0</span>
    <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">!=</span> <span class="mi">0</span>

    <span class="c1"># Calculamos el MAPE solo para los valores donde y_true no es cero.</span>
    <span class="c1"># La fórmula del MAPE es el promedio del valor absoluto del error porcentual entre y_true y y_pred</span>
    <span class="c1"># Multiplicamos por 100 para convertirlo en porcentaje</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">])</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Retornamos el valor del MAPE</span>
    <span class="k">return</span> <span class="n">mape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grafica</span><span class="p">(</span><span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">xlim_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim_test</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># Gráfico del conjunto de entrenamiento</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad original&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train_pred</span><span class="p">)),</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad predicha&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00B2EE&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocidad del viento&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_train</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1"># Gráfico del conjunto de prueba</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad original&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test_pred</span><span class="p">)),</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad predicha&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00B2EE&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocidad del viento&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_test</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Este método garantiza que los valores donde el valor verdadero es cero no se incluyan en el cálculo, evitando errores de división por cero y proporcionando una evaluación más precisa del desempeño de los modelos. A continuación, aplicaremos esta métrica, junto con otras como el <span class="math notranslate nohighlight">\(RMSE\)</span> y el <span class="math notranslate nohighlight">\(R^2\)</span>, para evaluar el desempeño de cada uno de los modelos en las distintas variables objetivo.</p>
</section>
<section id="metodos-para-realizar-las-graficas">
<h2><strong>Métodos para realizar las gráficas</strong><a class="headerlink" href="#metodos-para-realizar-las-graficas" title="Link to this heading">#</a></h2>
<p>En esta sección, se desarrollan métodos para generar gráficas de las predicciones y los residuos, con el propósito de optimizar el código para cada uno de los modelos a implementar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grafica</span><span class="p">(</span><span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">):</span>
    <span class="c1"># Calcular R² y RMSE</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># Gráfico del conjunto de entrenamiento</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Entrenamiento&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>  <span class="c1"># Azul oscuro</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_train</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_train</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Referencia&quot;</span><span class="p">)</span>  <span class="c1"># Línea de referencia</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Velocidad original&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad predicha&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_train</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Gráfico del conjunto de prueba</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Prueba&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#00B2EE&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>  <span class="c1"># Azul claro</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Referencia&quot;</span><span class="p">)</span>  <span class="c1"># Línea de referencia</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Velocidad original&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad predicha&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_test</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grafica_residuos</span><span class="p">(</span><span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">residuos</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Histograma de los residuos</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograma de los Residuos (</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Valor del Residuo&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

    <span class="c1"># Gráfico de autocorrelación</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">vlines_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#00008B&#39;</span><span class="p">},</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Autocorrelación de los Residuos (</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="metodos-para-los-modelos-de-regresion">
<h2><strong>Métodos para los modelos de regresión</strong><a class="headerlink" href="#metodos-para-los-modelos-de-regresion" title="Link to this heading">#</a></h2>
<p>A continuación se presenta un método para cada uno de los modelos de regresión, con el objetivo de reducir la cantidad de código repetido. Estos métodos se encargan de escalar los datos, encontrar los mejores hiperparámetros, evaluar los modelos, calcular las métricas y generar las predicciones, utilizando los conjuntos de datos <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>, <code class="docutils literal notranslate"><span class="pre">X_test</span></code> y <code class="docutils literal notranslate"><span class="pre">y_test</span></code>.</p>
<p>Para escalar los datos, se emplea <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code>, debido a que asegura una distribución con media cero y desviación estándar unitaria, lo cual es crucial para modelos sensibles a las escalas de las variables. Como validación cruzada se utiliza <code class="docutils literal notranslate"><span class="pre">KFold</span></code> con <code class="docutils literal notranslate"><span class="pre">shuffle</span> <span class="pre">=</span> <span class="pre">False</span></code>, ya que los datos están ordenados cronológicamente y es necesario mantener ese orden para evitar fugas de información, lo cual es especialmente relevante en la predicción de la velocidad del viento, donde la secuencia temporal puede impactar significativamente en los resultados.</p>
<p>Este proceso se aplica a cada uno de los modelos de regresión, incluyendo KNN, regresión lineal, Ridge, Lasso, Árbol de decisión regresor, Random Forest Regressor, XGBoost y SVR, garantizando así un flujo de trabajo consistente y eficiente para cada técnica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline_knn_reg</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsRegressor</span><span class="p">())])</span>

    <span class="n">param_grid_knn_reg</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">],</span> <span class="s1">&#39;knn__p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">grid_knn_reg</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_knn_reg</span><span class="p">,</span> <span class="n">param_grid_knn_reg</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>

    <span class="n">grid_knn_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_knn_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> 
    <span class="n">y_pred_knn_reg</span> <span class="o">=</span> <span class="n">grid_knn_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_knn_reg</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn_reg</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn_reg</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn_reg</span><span class="p">))</span>

    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># p-value</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;K-NN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span>
    <span class="p">})</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;K-NN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_knn_reg</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;ridge&#39;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">())])</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ridge__alpha&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">))}</span>
    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>
    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;lasso&#39;</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">())])</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lasso__alpha&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">))}</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Lasso Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>
    
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())])</span>

    <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>


    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Linear Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>
    
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;tree&#39;</span><span class="p">,</span> <span class="n">DecisionTreeRegressor</span><span class="p">())])</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tree__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]}</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Decision Tree&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>
    
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Tree decision Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;forest&#39;</span><span class="p">,</span> <span class="n">RandomForestRegressor</span><span class="p">())])</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;forest__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span>
        <span class="s1">&#39;forest__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Random Forest&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>

    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Random Forest Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;xgb&#39;</span><span class="p">,</span> <span class="n">XGBRegressor</span><span class="p">())])</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;xgb__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
        <span class="s1">&#39;xgb__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
        <span class="s1">&#39;xgb__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>
    
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),(</span><span class="s1">&#39;svr&#39;</span><span class="p">,</span> <span class="n">SVR</span><span class="p">())</span>
    <span class="p">])</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;svr__kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span>
        <span class="s1">&#39;svr__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;svr__gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span>  <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kf</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">jb_test_stat</span><span class="p">,</span> <span class="n">jb_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">lb_test</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">lb_test</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;SVR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jb_p_value</span>
    <span class="p">})</span>
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;SVR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Para cada una de las alturas de la velocidad del viento, se aplicará el siguiente procedimiento:</p>
<ol class="arabic simple">
<li><p><strong>Separación del Conjunto de Datos</strong>:</p>
<ul class="simple">
<li><p>Separamos el conjunto de datos en <code class="docutils literal notranslate"><span class="pre">X{i}</span></code>, que contiene las variables explicativas relacionadas con la altura <code class="docutils literal notranslate"><span class="pre">i</span></code>, y <code class="docutils literal notranslate"><span class="pre">y{i}</span></code>, que representa la velocidad del viento a esa altura. Cabe recordar que existen cinco alturas a evaluar: 100 m (sensor 1), 100 m (sensor 2), 80 m (sensor 1), 80 m (sensor 2), y 60 m.</p></li>
</ul>
</li>
<li><p><strong>División en Conjuntos de Entrenamiento y Prueba</strong>:</p>
<ul class="simple">
<li><p>Utilizando <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code>, dividimos los datos en <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">X_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code> y <code class="docutils literal notranslate"><span class="pre">y_test</span></code>.</p></li>
</ul>
</li>
<li><p><strong>Aplicación de Modelos de Regresión</strong>:</p>
<ul class="simple">
<li><p>Se aplican los modelos, generando una tabla que contiene las métricas de evaluación y los valores de los residuos.</p></li>
</ul>
</li>
<li><p><strong>Visualización de Resultados</strong>:</p>
<ul class="simple">
<li><p>Se grafican las predicciones contra los valores reales, tanto en el conjunto de entrenamiento como en el de prueba.</p></li>
<li><p>Se generan gráficos para evaluar la normalidad de los residuos (histograma de normalidad) y su autocorrelación.</p></li>
</ul>
</li>
</ol>
</section>
<section id="modelo-1-wind-speed-100-metros-sensor-1">
<h2><strong>Modelo 1: Wind speed 100 metros (Sensor 1)</strong><a class="headerlink" href="#modelo-1-wind-speed-100-metros-sensor-1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento80m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos1</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados1</span><span class="p">)</span>
<span class="n">resultados1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>8.170143</td>
      <td>1.204795</td>
      <td>0.927956</td>
      <td>0.712118</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>32.218242</td>
      <td>2.983672</td>
      <td>0.558151</td>
      <td>0.450426</td>
      <td>1.730091e-69</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>32.214461</td>
      <td>2.983710</td>
      <td>0.558140</td>
      <td>0.449601</td>
      <td>4.903189e-69</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>32.212888</td>
      <td>2.983655</td>
      <td>0.558156</td>
      <td>0.449567</td>
      <td>4.019790e-69</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree</td>
      <td>14.608610</td>
      <td>1.915615</td>
      <td>0.817867</td>
      <td>0.655369</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest</td>
      <td>0.127716</td>
      <td>1.505340</td>
      <td>0.887529</td>
      <td>0.284184</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost</td>
      <td>0.111021</td>
      <td>1.345177</td>
      <td>0.910189</td>
      <td>0.420752</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>0.210388</td>
      <td>2.224428</td>
      <td>0.754411</td>
      <td>0.503094</td>
      <td>3.556490e-158</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos1</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bdfc82d5301bc1ccd4d45ff663d420408cff33fcdcf6157cc8a3b14d25ceb171.png" src="_images/bdfc82d5301bc1ccd4d45ff663d420408cff33fcdcf6157cc8a3b14d25ceb171.png" />
<img alt="_images/fa96ecf773c0a8041b53a505d7f58d99ed7773beda348db73ba8f8c2a7962477.png" src="_images/fa96ecf773c0a8041b53a505d7f58d99ed7773beda348db73ba8f8c2a7962477.png" />
<img alt="_images/cd29549491a02013ed3010ee935926ba7d52b2144e3f15ca24ca65f15eca6b9f.png" src="_images/cd29549491a02013ed3010ee935926ba7d52b2144e3f15ca24ca65f15eca6b9f.png" />
<img alt="_images/90ccf3aaa0b260d44c80bd56cbae09565151bcd11fc9192e0ba741c95c55caa7.png" src="_images/90ccf3aaa0b260d44c80bd56cbae09565151bcd11fc9192e0ba741c95c55caa7.png" />
<img alt="_images/18ac3b478a07fcfed8430b8781180ed5b19a0f4e7744534120dca1bd9b9156b6.png" src="_images/18ac3b478a07fcfed8430b8781180ed5b19a0f4e7744534120dca1bd9b9156b6.png" />
<img alt="_images/be5fadecac879c50e77fc368eb74ee7da464b5bfc60242250a0b86b6bc88d249.png" src="_images/be5fadecac879c50e77fc368eb74ee7da464b5bfc60242250a0b86b6bc88d249.png" />
<img alt="_images/b23ac11eedb7c99ba8b17dd994cc4c5fda5b7fa9d55b2ea190a8a07f69fb811e.png" src="_images/b23ac11eedb7c99ba8b17dd994cc4c5fda5b7fa9d55b2ea190a8a07f69fb811e.png" />
<img alt="_images/bf80e33ed87eb6612cb06a558b826610a80e93a29a3eaf9a7d3c7afcbe3b4dec.png" src="_images/bf80e33ed87eb6612cb06a558b826610a80e93a29a3eaf9a7d3c7afcbe3b4dec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos1</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/50b2c910aabf0a83c0f0f3d53a8fc4517900cb86702dfb5c513c7c2c163e5baa.png" src="_images/50b2c910aabf0a83c0f0f3d53a8fc4517900cb86702dfb5c513c7c2c163e5baa.png" />
<img alt="_images/5adc8de36deadd29076ac6529a38451c0fe1cea8d29035b8e0a84c7adc197626.png" src="_images/5adc8de36deadd29076ac6529a38451c0fe1cea8d29035b8e0a84c7adc197626.png" />
<img alt="_images/40f4c06354fd18c02c969ce10c9f23d69b1da8f89e54769e0cce07f393f75947.png" src="_images/40f4c06354fd18c02c969ce10c9f23d69b1da8f89e54769e0cce07f393f75947.png" />
<img alt="_images/bdb350e4b0f0f52aeeb38b75c87118765cad8c58e8c11e4a8717c6e0a642fa44.png" src="_images/bdb350e4b0f0f52aeeb38b75c87118765cad8c58e8c11e4a8717c6e0a642fa44.png" />
<img alt="_images/aeea360c96fdfa843c0a3da0b12a86a802861b695baea87ca71b4a9a1a580d46.png" src="_images/aeea360c96fdfa843c0a3da0b12a86a802861b695baea87ca71b4a9a1a580d46.png" />
<img alt="_images/892e66dad246d07dc36dd1913179519ba0eeff7e4de3b0f47c7f594efe49aad8.png" src="_images/892e66dad246d07dc36dd1913179519ba0eeff7e4de3b0f47c7f594efe49aad8.png" />
<img alt="_images/779b527628e5285bad5b60126e207d36283fc98f239b0dc688e4a9a12820c426.png" src="_images/779b527628e5285bad5b60126e207d36283fc98f239b0dc688e4a9a12820c426.png" />
<img alt="_images/4d8c9d61d25eda767f7a1e7a747f6d3cbe51207585980b9cf241f3be23d6c54d.png" src="_images/4d8c9d61d25eda767f7a1e7a747f6d3cbe51207585980b9cf241f3be23d6c54d.png" />
</div>
</div>
</section>
<section id="modelo-2-wind-speed-100-metros-sensor-2">
<h2><strong>Modelo 2: Wind speed 100 metros (Sensor 2)</strong><a class="headerlink" href="#modelo-2-wind-speed-100-metros-sensor-2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento80m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos2</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados2</span><span class="p">)</span>
<span class="n">resultados2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>8.239754</td>
      <td>1.193317</td>
      <td>0.927750</td>
      <td>0.699033</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>32.354650</td>
      <td>2.949732</td>
      <td>0.558541</td>
      <td>0.451696</td>
      <td>5.893567e-70</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>32.350837</td>
      <td>2.949770</td>
      <td>0.558529</td>
      <td>0.450837</td>
      <td>1.703740e-69</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>32.349087</td>
      <td>2.949714</td>
      <td>0.558546</td>
      <td>0.450804</td>
      <td>1.392381e-69</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree</td>
      <td>14.628296</td>
      <td>1.887265</td>
      <td>0.819286</td>
      <td>0.262838</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest</td>
      <td>0.130011</td>
      <td>1.491880</td>
      <td>0.887074</td>
      <td>0.317484</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost</td>
      <td>0.112810</td>
      <td>1.342296</td>
      <td>0.908584</td>
      <td>0.340044</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>0.211875</td>
      <td>2.203696</td>
      <td>0.753607</td>
      <td>0.501667</td>
      <td>9.112736e-159</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos2</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e17fc3f2088162d27a6889598f0862d0b685d6f59e0d75e1e78cafce18f989a7.png" src="_images/e17fc3f2088162d27a6889598f0862d0b685d6f59e0d75e1e78cafce18f989a7.png" />
<img alt="_images/ef322dbc0da53ea5d8cae6bd35062a46052b72265b4d53157ce98de6c1921dd2.png" src="_images/ef322dbc0da53ea5d8cae6bd35062a46052b72265b4d53157ce98de6c1921dd2.png" />
<img alt="_images/793e7c5e901011abb757f6a5c769b0563eeea3b88ab609363888fe9e46bbda04.png" src="_images/793e7c5e901011abb757f6a5c769b0563eeea3b88ab609363888fe9e46bbda04.png" />
<img alt="_images/dc2fd23ca7295bbf232972e9a4e1e2fdc506b46100d76493c1a195c214ce1082.png" src="_images/dc2fd23ca7295bbf232972e9a4e1e2fdc506b46100d76493c1a195c214ce1082.png" />
<img alt="_images/fa13b182e3ecea4f0b4d6dc089d570fc5007cc464c987db5a2ef137009102b7a.png" src="_images/fa13b182e3ecea4f0b4d6dc089d570fc5007cc464c987db5a2ef137009102b7a.png" />
<img alt="_images/2510867aabbd14d87626446beedd4c2693b3915785cf52e78778f6a1375e1890.png" src="_images/2510867aabbd14d87626446beedd4c2693b3915785cf52e78778f6a1375e1890.png" />
<img alt="_images/86fac5dca22235b1e45d0e0575d726cd770c94d0888f249eb10f658b3b6262cf.png" src="_images/86fac5dca22235b1e45d0e0575d726cd770c94d0888f249eb10f658b3b6262cf.png" />
<img alt="_images/66a7042909f52a11515c49da5728e700827bf37c5732eea85903fd1c9a75c080.png" src="_images/66a7042909f52a11515c49da5728e700827bf37c5732eea85903fd1c9a75c080.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos2</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7cd3b5a3a05950f98b68c89f6aa2f88ee7adc83b582a18c26559709d12780286.png" src="_images/7cd3b5a3a05950f98b68c89f6aa2f88ee7adc83b582a18c26559709d12780286.png" />
<img alt="_images/8607e7d02d2be8d607f631d984c0e27557b716a2a540078af5354b8a120d0bdc.png" src="_images/8607e7d02d2be8d607f631d984c0e27557b716a2a540078af5354b8a120d0bdc.png" />
<img alt="_images/571f981e0e6be758b7f79048cefa3aabc73d6771b0d01c794893dc7865922a0a.png" src="_images/571f981e0e6be758b7f79048cefa3aabc73d6771b0d01c794893dc7865922a0a.png" />
<img alt="_images/b0ea9a94079c8edddbbda1979feb4a7fcfe9cf15214d5339df59c89e3e34a4c4.png" src="_images/b0ea9a94079c8edddbbda1979feb4a7fcfe9cf15214d5339df59c89e3e34a4c4.png" />
<img alt="_images/91bc57a36a2721aba1dc95d39d9449b37ad5ba825ffbe8b7cf96b6e2c0e79630.png" src="_images/91bc57a36a2721aba1dc95d39d9449b37ad5ba825ffbe8b7cf96b6e2c0e79630.png" />
<img alt="_images/342d23511d52b88b0c91c4f424e99a503002773931707d23e6ccb3ecee02661f.png" src="_images/342d23511d52b88b0c91c4f424e99a503002773931707d23e6ccb3ecee02661f.png" />
<img alt="_images/181c4590ea794520eb9f9eca8f9d75bfe6d33e861e6a8b2ec571f340ce08b07a.png" src="_images/181c4590ea794520eb9f9eca8f9d75bfe6d33e861e6a8b2ec571f340ce08b07a.png" />
<img alt="_images/6ccf8e90eb080099ede140291aac47116a2a7a37b9ad9997f0bad068b7432f8b.png" src="_images/6ccf8e90eb080099ede140291aac47116a2a7a37b9ad9997f0bad068b7432f8b.png" />
</div>
</div>
</section>
<section id="modelo-3-wind-speed-80-metros-sensor-1">
<h2><strong>Modelo 3: Wind speed 80 metros (Sensor 1)</strong><a class="headerlink" href="#modelo-3-wind-speed-80-metros-sensor-1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento100m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos3</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span><span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span><span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span><span class="n">resultados_graficos3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados3</span><span class="p">)</span>
<span class="n">resultados3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>8.358144</td>
      <td>1.158691</td>
      <td>0.928144</td>
      <td>0.865322</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>32.314343</td>
      <td>2.872271</td>
      <td>0.558449</td>
      <td>0.433729</td>
      <td>3.236977e-68</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>32.310101</td>
      <td>2.872316</td>
      <td>0.558435</td>
      <td>0.432956</td>
      <td>1.037228e-67</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>32.307985</td>
      <td>2.872257</td>
      <td>0.558453</td>
      <td>0.432788</td>
      <td>8.671614e-68</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree</td>
      <td>14.714522</td>
      <td>1.854332</td>
      <td>0.815963</td>
      <td>0.425502</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest</td>
      <td>0.127730</td>
      <td>1.451526</td>
      <td>0.887234</td>
      <td>0.155106</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost</td>
      <td>0.117078</td>
      <td>1.360584</td>
      <td>0.900921</td>
      <td>0.323485</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>0.207560</td>
      <td>2.128939</td>
      <td>0.757419</td>
      <td>0.388942</td>
      <td>8.076865e-167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos3</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/995beca4312aa4045c62367cb8732a4fd61db76502224c7fd0e334dd54a7c16b.png" src="_images/995beca4312aa4045c62367cb8732a4fd61db76502224c7fd0e334dd54a7c16b.png" />
<img alt="_images/313e6ccfd5fe8c7b0a9861af6bbdc5d60e573e47aee0a0634fa9c1277f5c305f.png" src="_images/313e6ccfd5fe8c7b0a9861af6bbdc5d60e573e47aee0a0634fa9c1277f5c305f.png" />
<img alt="_images/baddb37e46513181d4145b5e71e9036c6e0ef3f5ce7a12cd313dc3a049d32693.png" src="_images/baddb37e46513181d4145b5e71e9036c6e0ef3f5ce7a12cd313dc3a049d32693.png" />
<img alt="_images/58317ce77a3b44149818cc8f1f8ec6ebfc451c9c2ba68e5de8f6c6326e4affe5.png" src="_images/58317ce77a3b44149818cc8f1f8ec6ebfc451c9c2ba68e5de8f6c6326e4affe5.png" />
<img alt="_images/6fdf6fe0445926b239a4adf04b7aa4c891e97d6c036cf0d71871cb9011b9cf35.png" src="_images/6fdf6fe0445926b239a4adf04b7aa4c891e97d6c036cf0d71871cb9011b9cf35.png" />
<img alt="_images/f3bc017dd0f0551db209e88e0c7b6cfd3e47d6e813480b8996971b8b7c0ba49d.png" src="_images/f3bc017dd0f0551db209e88e0c7b6cfd3e47d6e813480b8996971b8b7c0ba49d.png" />
<img alt="_images/41e5ad07fe1a55930dc295b548068c1c99d9950e8c39f174768ed9b09f80bc08.png" src="_images/41e5ad07fe1a55930dc295b548068c1c99d9950e8c39f174768ed9b09f80bc08.png" />
<img alt="_images/b0c13fd9b387a41adffcbf6dbdc718260eeceb014e32a5441961f1b4865a863c.png" src="_images/b0c13fd9b387a41adffcbf6dbdc718260eeceb014e32a5441961f1b4865a863c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos3</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c87c5ee14b6dd622dabeb6268a41e976825a11724048beb761549c6f76e9c295.png" src="_images/c87c5ee14b6dd622dabeb6268a41e976825a11724048beb761549c6f76e9c295.png" />
<img alt="_images/eb14ebd299fa68369ed850f79fd1e32a52285afd3573632f9991b9763c1efe52.png" src="_images/eb14ebd299fa68369ed850f79fd1e32a52285afd3573632f9991b9763c1efe52.png" />
<img alt="_images/715f27489709091cb59748666d14c8a8db535a7feb14ca83438bd47a004496d7.png" src="_images/715f27489709091cb59748666d14c8a8db535a7feb14ca83438bd47a004496d7.png" />
<img alt="_images/b60cbcd762661976a8850c40fcbcb58ccafc8f21fd8bc23c58aede600bc5663f.png" src="_images/b60cbcd762661976a8850c40fcbcb58ccafc8f21fd8bc23c58aede600bc5663f.png" />
<img alt="_images/ba7bceb87c2f56e729bcfed36e4adb08347bace00e4506b884ce2d4af5a657ef.png" src="_images/ba7bceb87c2f56e729bcfed36e4adb08347bace00e4506b884ce2d4af5a657ef.png" />
<img alt="_images/de83620762638fc749ee69824f69e0ae85165fa965b6cd813072ee3d14bf5936.png" src="_images/de83620762638fc749ee69824f69e0ae85165fa965b6cd813072ee3d14bf5936.png" />
<img alt="_images/7422e3424f0b98823a9a9c12d2f04c62434069d7854f58d3c696830764e378ff.png" src="_images/7422e3424f0b98823a9a9c12d2f04c62434069d7854f58d3c696830764e378ff.png" />
<img alt="_images/e68e51e9b5c873a920f31b4f357e8ff5a17de31b088e3b4d2dbcba76f62da397.png" src="_images/e68e51e9b5c873a920f31b4f357e8ff5a17de31b088e3b4d2dbcba76f62da397.png" />
</div>
</div>
</section>
<section id="modelo-4-wind-speed-80-metros-sensor-2">
<h2><strong>Modelo 4: Wind speed 80 metros (Sensor 2)</strong><a class="headerlink" href="#modelo-4-wind-speed-80-metros-sensor-2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X4</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento100m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y4</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados4</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos4</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados4</span><span class="p">)</span>
<span class="n">resultados4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>8.324089</td>
      <td>1.156131</td>
      <td>0.928070</td>
      <td>0.856604</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>32.001932</td>
      <td>2.859538</td>
      <td>0.559962</td>
      <td>0.436231</td>
      <td>1.303787e-68</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>31.997784</td>
      <td>2.859583</td>
      <td>0.559948</td>
      <td>0.435434</td>
      <td>4.170503e-68</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>31.995739</td>
      <td>2.859525</td>
      <td>0.559966</td>
      <td>0.435269</td>
      <td>3.492348e-68</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree</td>
      <td>14.731821</td>
      <td>1.879576</td>
      <td>0.809884</td>
      <td>0.710458</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest</td>
      <td>0.127688</td>
      <td>1.445338</td>
      <td>0.887582</td>
      <td>0.136359</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost</td>
      <td>0.111950</td>
      <td>1.302750</td>
      <td>0.908669</td>
      <td>0.276298</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>0.206998</td>
      <td>2.125639</td>
      <td>0.756848</td>
      <td>0.383440</td>
      <td>2.054165e-164</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos4</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee916afbc097dcaf59d5571bca5ed2dfb15bb959479fc795e2f76628a5ca7b23.png" src="_images/ee916afbc097dcaf59d5571bca5ed2dfb15bb959479fc795e2f76628a5ca7b23.png" />
<img alt="_images/d7b680549c8e4858960bec174f1d611d10a7ad5088f755b5efa2efe804069590.png" src="_images/d7b680549c8e4858960bec174f1d611d10a7ad5088f755b5efa2efe804069590.png" />
<img alt="_images/e3ee4f4096a240602c548ed1b3939afad9dcede8f994de3e30f63ab871d23ebc.png" src="_images/e3ee4f4096a240602c548ed1b3939afad9dcede8f994de3e30f63ab871d23ebc.png" />
<img alt="_images/67ccdd2edef86931594cb9227fffd905f7b188d0a8ca3f3875fda2418f9a1c7b.png" src="_images/67ccdd2edef86931594cb9227fffd905f7b188d0a8ca3f3875fda2418f9a1c7b.png" />
<img alt="_images/d8578e18e6058357b109885563231d9a46baf253cbf70e7db1bae40e143a4fde.png" src="_images/d8578e18e6058357b109885563231d9a46baf253cbf70e7db1bae40e143a4fde.png" />
<img alt="_images/e20bf9fef53285d2087a2d257adf9ac03eb9f7458288b1452fee1c618eea61aa.png" src="_images/e20bf9fef53285d2087a2d257adf9ac03eb9f7458288b1452fee1c618eea61aa.png" />
<img alt="_images/539e6049f310fbff7fdaee6ae082029d9abcff9f66116baf6da83611a7331400.png" src="_images/539e6049f310fbff7fdaee6ae082029d9abcff9f66116baf6da83611a7331400.png" />
<img alt="_images/2a0a5de73aa15dc876fcd059133e2cd871fe791c21c6c55639ddcd966807cf31.png" src="_images/2a0a5de73aa15dc876fcd059133e2cd871fe791c21c6c55639ddcd966807cf31.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos4</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7bb7a71d2eff3df4822a1b9f6887a557745a12052a42fca5030683c9de108ba7.png" src="_images/7bb7a71d2eff3df4822a1b9f6887a557745a12052a42fca5030683c9de108ba7.png" />
<img alt="_images/684a742bf00475715d4991b4c3210a95e62de1db4d12c0df4b265ce21443170f.png" src="_images/684a742bf00475715d4991b4c3210a95e62de1db4d12c0df4b265ce21443170f.png" />
<img alt="_images/c29b91344023cc24854d763c01a37e283aa8905288cc1f640d452185328b0cb2.png" src="_images/c29b91344023cc24854d763c01a37e283aa8905288cc1f640d452185328b0cb2.png" />
<img alt="_images/37e8a9a93911d91fd45a0c3fb51bc0de47615101a38e37e64f385dd4d74aaff6.png" src="_images/37e8a9a93911d91fd45a0c3fb51bc0de47615101a38e37e64f385dd4d74aaff6.png" />
<img alt="_images/bee5255a859b0c3c4d973788d045ed8b1abf76e8d8169fa2d6037ef04145ac8d.png" src="_images/bee5255a859b0c3c4d973788d045ed8b1abf76e8d8169fa2d6037ef04145ac8d.png" />
<img alt="_images/57de5d09401d0461be5b5f1b444f34998dce291d0369a1f4b536abe17e6689cb.png" src="_images/57de5d09401d0461be5b5f1b444f34998dce291d0369a1f4b536abe17e6689cb.png" />
<img alt="_images/0ffe4874c577d09357432967a213f6a1a32e5cd1b47dcc4efbd5d43940d31b11.png" src="_images/0ffe4874c577d09357432967a213f6a1a32e5cd1b47dcc4efbd5d43940d31b11.png" />
<img alt="_images/23945fbbd85d9cb9e401fd1617375640e30d524724b5def065d6032d7b3062a3.png" src="_images/23945fbbd85d9cb9e401fd1617375640e30d524724b5def065d6032d7b3062a3.png" />
</div>
</div>
</section>
<section id="modelo-5-wind-speed-60-metros">
<h2><strong>Modelo 5: Wind speed 60 metros</strong><a class="headerlink" href="#modelo-5-wind-speed-60-metros" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X5</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento80m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento100m&#39;</span><span class="p">])</span>
<span class="n">y5</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento60m&#39;</span><span class="p">]</span>


<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X5</span><span class="p">,</span> <span class="n">y5</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados5</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos5</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span><span class="n">resultados_graficos5</span> <span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span><span class="n">resultados_graficos5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados5</span><span class="p">)</span> 
<span class="n">resultados5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>8.890400</td>
      <td>1.133081</td>
      <td>0.925664</td>
      <td>0.795328</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>32.393069</td>
      <td>2.776450</td>
      <td>0.553671</td>
      <td>0.363604</td>
      <td>3.932731e-67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>32.391389</td>
      <td>2.776492</td>
      <td>0.553657</td>
      <td>0.363496</td>
      <td>7.919629e-67</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>32.388608</td>
      <td>2.776441</td>
      <td>0.553673</td>
      <td>0.363178</td>
      <td>7.883555e-67</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree</td>
      <td>15.181163</td>
      <td>1.840293</td>
      <td>0.803912</td>
      <td>0.618823</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest</td>
      <td>0.130781</td>
      <td>1.421475</td>
      <td>0.883008</td>
      <td>0.114057</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost</td>
      <td>0.115935</td>
      <td>1.279917</td>
      <td>0.905149</td>
      <td>0.409827</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>0.209240</td>
      <td>2.059412</td>
      <td>0.754437</td>
      <td>0.406323</td>
      <td>1.331446e-223</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos5</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/df35e65982257820e8c34701e47fde3c478c3985963b8474e5a810fc54c8db30.png" src="_images/df35e65982257820e8c34701e47fde3c478c3985963b8474e5a810fc54c8db30.png" />
<img alt="_images/f991a598e4ef044f54f7e76d074d33d606c8f312053067532cbbd51afc860ae6.png" src="_images/f991a598e4ef044f54f7e76d074d33d606c8f312053067532cbbd51afc860ae6.png" />
<img alt="_images/087575f8fc44b53a7a1a4bbeabfc4a26eb6366eb17b7f7d6725ae6bca201e013.png" src="_images/087575f8fc44b53a7a1a4bbeabfc4a26eb6366eb17b7f7d6725ae6bca201e013.png" />
<img alt="_images/67287d1c64364b613b4e0e83765702bdd4b7a4dfe99e806ba23bd699790740c1.png" src="_images/67287d1c64364b613b4e0e83765702bdd4b7a4dfe99e806ba23bd699790740c1.png" />
<img alt="_images/73bc9288b076096ee16036b037ef4b5888db9419b1d7e8e7ca50d6adbe77a5ab.png" src="_images/73bc9288b076096ee16036b037ef4b5888db9419b1d7e8e7ca50d6adbe77a5ab.png" />
<img alt="_images/50f99f31b70d456f9721979809dac7ca8b079b8ab36a4bb41a1a3512d0b2d22a.png" src="_images/50f99f31b70d456f9721979809dac7ca8b079b8ab36a4bb41a1a3512d0b2d22a.png" />
<img alt="_images/f6ead5b01349c67396b9b80080cb341605ec072745f57b6193eaf48895b050fa.png" src="_images/f6ead5b01349c67396b9b80080cb341605ec072745f57b6193eaf48895b050fa.png" />
<img alt="_images/23bdfe015f47c3ee2c7aff7f584d9239ae1664f11b6617127659c3ae79d7784b.png" src="_images/23bdfe015f47c3ee2c7aff7f584d9239ae1664f11b6617127659c3ae79d7784b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos5</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/43b341ee2690b5e8aa5a555a06e96f9e9a3e54ba28874b23e2040d587d19f5d6.png" src="_images/43b341ee2690b5e8aa5a555a06e96f9e9a3e54ba28874b23e2040d587d19f5d6.png" />
<img alt="_images/e300b4e4459823ec5186d57a28e7b833c03ebc4cf5280ebbeeb159f4f232aada.png" src="_images/e300b4e4459823ec5186d57a28e7b833c03ebc4cf5280ebbeeb159f4f232aada.png" />
<img alt="_images/53f59482249500f74c48f80eef8719887a913a183bf1780716c1f64ac2b1b979.png" src="_images/53f59482249500f74c48f80eef8719887a913a183bf1780716c1f64ac2b1b979.png" />
<img alt="_images/a8ad28247273857df54d05d5bbeeae00d89ac369ca322cbb2ef0fc74e4cedf78.png" src="_images/a8ad28247273857df54d05d5bbeeae00d89ac369ca322cbb2ef0fc74e4cedf78.png" />
<img alt="_images/7a992d3b76d0017c3423175cb0296564edb8db2333715b20e7e471d9e4cf9e24.png" src="_images/7a992d3b76d0017c3423175cb0296564edb8db2333715b20e7e471d9e4cf9e24.png" />
<img alt="_images/3ab474c2e5f219a809e816ef039ce591fab4fa548d456d2266489af223473775.png" src="_images/3ab474c2e5f219a809e816ef039ce591fab4fa548d456d2266489af223473775.png" />
<img alt="_images/8ccd0b9e0bcbc2e161f4a1d0f33b63e517fd7f31bdd66b36b3f0b2c8a1a51bcf.png" src="_images/8ccd0b9e0bcbc2e161f4a1d0f33b63e517fd7f31bdd66b36b3f0b2c8a1a51bcf.png" />
<img alt="_images/bdf2cd828d1af6f4d67ed0279da25873b352e5478b6788d801a0e58aa4f73384.png" src="_images/bdf2cd828d1af6f4d67ed0279da25873b352e5478b6788d801a0e58aa4f73384.png" />
</div>
</div>
</section>
<section id="conclusion-general">
<h2><strong>Conclusión general</strong><a class="headerlink" href="#conclusion-general" title="Link to this heading">#</a></h2>
<p>A continuación, se presenta una conclusión global considerando los resultados para las cinco alturas medidas: 100 m (sensor 1), 100 m (sensor 2), 80 m (sensor 1), 80 m (sensor 2) y 60 m. En general, se observa que las tendencias en los errores y métricas de rendimiento son similares para todas las alturas, lo cual sugiere una consistencia en cómo los diferentes modelos responden a la variabilidad de la velocidad del viento en las distintas alturas.</p>
<p>En cuanto a los modelos tenemos lo siguiente:</p>
<ul class="simple">
<li><p><strong>Modelos Lineales (<code class="docutils literal notranslate"><span class="pre">Ridge</span></code>, <code class="docutils literal notranslate"><span class="pre">Lasso</span></code>, <code class="docutils literal notranslate"><span class="pre">Linear</span> <span class="pre">Regression</span></code>)</strong>: Estos modelos mostraron valores consistentemente altos de MAPE y RMSE, así como valores bajos de <code class="docutils literal notranslate"><span class="pre">R²</span></code>. Esto indica un mal ajuste a la complejidad de los datos para cada una de las alturas. La similitud en los resultados para las diferentes alturas confirma que estos modelos tienen dificultades para capturar la no linealidad presente en los datos.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">K-NN</span></code></strong>: Aunque <code class="docutils literal notranslate"><span class="pre">K-NN</span></code> muestra valores altos de <code class="docutils literal notranslate"><span class="pre">R²</span></code> y bajos de error, en las gráficas se evidencia un claro sobreajuste, especialmente en los conjuntos de entrenamiento, donde el ajuste es prácticamente perfecto (<code class="docutils literal notranslate"><span class="pre">R²</span></code>=1). Sin embargo, en los conjuntos de prueba, la dispersión es mayor, lo que sugiere que <code class="docutils literal notranslate"><span class="pre">K-NN</span></code> no generaliza bien. Esto indica que, aunque los datos pueden parecer bien ajustados en métricas cuantitativas, el modelo sufre de un sobreajuste significativo, especialmente visible en las gráficas de dispersión.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Decision</span> <span class="pre">Tree</span></code></strong> y <strong><code class="docutils literal notranslate"><span class="pre">Random</span> <span class="pre">Forest</span></code></strong>: Estos modelos ofrecen un compromiso entre precisión y generalización. <code class="docutils literal notranslate"><span class="pre">Random</span> <span class="pre">Forest</span></code> presenta resultados relativamente buenos en cuanto a los errores (MAPE y RMSE) y mantiene un equilibrio adecuado entre <code class="docutils literal notranslate"><span class="pre">R²</span></code> y la capacidad de generalización. Aunque no muestra el mayor <code class="docutils literal notranslate"><span class="pre">R²</span></code>, las gráficas indican una menor tendencia al sobreajuste en comparación con <code class="docutils literal notranslate"><span class="pre">K-NN</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">XGBoost</span></code></strong>: Este modelo tiene métricas de rendimiento consistentes y se adapta bien a las distintas alturas, presentando resultados cercanos a <code class="docutils literal notranslate"><span class="pre">Random</span> <span class="pre">Forest</span></code>. Se observa un buen balance entre precisión y estabilidad, lo cual lo convierte en un modelo robusto. Sin embargo, notamos que en las gráficas hay un sobreajuste al comparar entre las predicciones en el conjunto de entrenamiento y prueba.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SVR</span></code> (Support Vector Regressor)</strong>: En las gráficas, <code class="docutils literal notranslate"><span class="pre">SVR</span></code> muestra un buen equilibrio entre rendimiento y generalización, con un ajuste que evita el sobreajuste visible en otros modelos como <code class="docutils literal notranslate"><span class="pre">K-NN</span></code>. Aunque no tiene el <code class="docutils literal notranslate"><span class="pre">R²</span></code> más alto, los gráficos de predicción frente a valores reales tanto en entrenamiento como en prueba muestran que <code class="docutils literal notranslate"><span class="pre">SVR</span></code> mantiene una tendencia cercana a la línea de referencia sin evidenciar un ajuste excesivo. Esto indica que <code class="docutils literal notranslate"><span class="pre">SVR</span></code> tiene una gran capacidad para adaptarse a la complejidad de los datos sin sobreajustarse, lo que lo hace particularmente adecuado para este conjunto de datos.</p></li>
</ul>
<p>Para todas las alturas, se observa que las tendencias son muy similares: los modelos lineales tienden a tener un bajo rendimiento debido a la complejidad de los datos, mientras que <code class="docutils literal notranslate"><span class="pre">K-NN</span></code>, a pesar de sus métricas cuantitativas, presenta problemas de sobreajuste. <code class="docutils literal notranslate"><span class="pre">Random</span> <span class="pre">Forest</span></code>, <code class="docutils literal notranslate"><span class="pre">XGBoost</span></code> y <code class="docutils literal notranslate"><span class="pre">SVR</span></code> se destacan como las mejores opciones, con <code class="docutils literal notranslate"><span class="pre">SVR</span></code> presentando el mejor comportamiento en términos de evitar el sobreajuste, lo que sugiere que puede ser la mejor opción para una predicción precisa y generalizable de la velocidad del viento a diferentes alturas.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="eda.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Análisis Exploratorio de Datos (EDA)</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="original.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Propuesta de modelo original</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos"><strong>Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracteristicas-principales-de-la-base-de-datos"><strong>Características principales de la base de datos</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>Modelos</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-realizar-las-graficas"><strong>Métodos para realizar las gráficas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-los-modelos-de-regresion"><strong>Métodos para los modelos de regresión</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-1-wind-speed-100-metros-sensor-1"><strong>Modelo 1: Wind speed 100 metros (Sensor 1)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-2-wind-speed-100-metros-sensor-2"><strong>Modelo 2: Wind speed 100 metros (Sensor 2)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-3-wind-speed-80-metros-sensor-1"><strong>Modelo 3: Wind speed 80 metros (Sensor 1)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-4-wind-speed-80-metros-sensor-2"><strong>Modelo 4: Wind speed 80 metros (Sensor 2)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-5-wind-speed-60-metros"><strong>Modelo 5: Wind speed 60 metros</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general"><strong>Conclusión general</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kanery Camargo y Emanuel Carbonell
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>