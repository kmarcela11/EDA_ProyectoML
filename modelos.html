
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelos de regresión &#8212; Proyecto final - Energía eólica</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modelos';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Propuesta de modelo original" href="original.html" />
    <link rel="prev" title="Análisis Exploratorio de Datos (EDA)" href="eda.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpeg" class="logo__image only-light" alt="Proyecto final - Energía eólica - Home"/>
    <script>document.write(`<img src="_static/logo.jpeg" class="logo__image only-dark" alt="Proyecto final - Energía eólica - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Proyecto Final - Energía Eólica
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="inicio.html"><strong>Contextualización del Proyecto</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="eda.html"><strong>Análisis Exploratorio de Datos (EDA)</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Modelos de regresión</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="original.html"><strong>Propuesta de modelo original</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="mates.html"><strong>Matemáticas del modelo original</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="implementacion.html"><strong>Implementación del modelo original</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="comparacion.html"><strong>Comparación de modelos</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusiones.html"><strong>Conclusiones y recomendaciones</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html"><strong>Bibliografía</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kmarcela11/ProyectoFinal_EnergiaEolica/tree/gh-pages" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kmarcela11/ProyectoFinal_EnergiaEolica/tree/gh-pages/issues/new?title=Issue%20on%20page%20%2Fmodelos.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/modelos.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelos de regresión</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos"><strong>Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracteristicas-principales-de-la-base-de-datos"><strong>Características principales de la base de datos</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Modelos de regresión</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-evaluacion"><strong>Métricas de evaluación</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-realizar-las-graficas"><strong>Métodos para realizar las gráficas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-los-modelos-de-regresion"><strong>Métodos para los modelos de regresión</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-regressor"><strong>KNN Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression"><strong>Ridge Regression</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression"><strong>Lasso Regression</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression"><strong>Linear Regression</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-regressor"><strong>Decision Tree Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-regressor"><strong>Random Forest Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-regressor"><strong>XGBoost Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svr-support-vector-regression"><strong>SVR (Support Vector Regression)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aspectos-importantes"><strong>Aspectos importantes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-1-wind-speed-100-metros-sensor-1"><strong>Modelo 1: Wind speed 100 metros (Sensor 1)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-2-wind-speed-100-metros-sensor-2"><strong>Modelo 2: Wind speed 100 metros (Sensor 2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-3-wind-speed-80-metros-sensor-1"><strong>Modelo 3: Wind speed 80 metros (Sensor 1)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-4-wind-speed-80-metros-sensor-2"><strong>Modelo 4: Wind speed 80 metros (Sensor 2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-5-wind-speed-60-metros"><strong>Modelo 5: Wind speed 60 metros</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-general"><strong>Interpretación general</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelos-de-regresion">
<h1><strong>Modelos de regresión</strong><a class="headerlink" href="#modelos-de-regresion" title="Link to this heading">#</a></h1>
<div style="text-align: justify; margin-bottom: 20px;">
    En esta sección del proyecto, se diseñan y analizan múltiples modelos de regresión con el propósito de investigar cómo las variables meteorológicas —como la dirección del viento, la temperatura, la presión y la humedad— afectan la velocidad del viento. Este análisis busca no solo identificar patrones clave, sino también capturar la naturaleza compleja de las interacciones entre dichas variables. Para lograrlo, se implementaron y evaluaron diversos enfoques de aprendizaje automático, comparando su desempeño en términos de precisión predictiva y eficiencia, con el objetivo de seleccionar los modelos más robustos y adecuados para describir estas relaciones.
</div><section id="librerias-y-modulos-necesarios">
<h2><strong>Librerías y modulos necesarios</strong><a class="headerlink" href="#librerias-y-modulos-necesarios" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Integer</span>
<span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">BayesSearchCV</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="datos">
<h2><strong>Datos</strong><a class="headerlink" href="#datos" title="Link to this heading">#</a></h2>
<p>Inicialmente, realizamos el cargue del conjunto de datos, los cuales provienen del proceso de exploración, transformación y limpieza descrito en detalle en el <a class="reference external" href="https://kmarcela11.github.io/ProyectoFinal_EnergiaEolica/eda.html">EDA</a>. Este procedimiento garantiza que la información esté depurada y lista para el análisis, asegurando condiciones óptimas para el desarrollo de modelos de aprendizaje automático y mejorando la calidad y confiabilidad de los resultados obtenidos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\kamac\OneDrive\Desktop\MachineLearningUN\EDA\ws_modelos.xlsx&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="caracteristicas-principales-de-la-base-de-datos">
<h3><strong>Características principales de la base de datos</strong><a class="headerlink" href="#caracteristicas-principales-de-la-base-de-datos" title="Link to this heading">#</a></h3>
<p>Para analizar las principales características de los datos, utilizamos los métodos <code class="docutils literal notranslate"><span class="pre">head()</span></code> y <code class="docutils literal notranslate"><span class="pre">tail()</span></code>, que nos permiten visualizar las primeras y últimas cinco filas/observaciones del conjunto de datos. Esto nos permite confirmar que los datos cubren un periodo temporal desde el 1 de enero de 2022 hasta el 16 de mayo de 2022, garantizando que la información está correctamente estructurada y alineada con el rango esperado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fecha</th>
      <th>VelViento100m_1</th>
      <th>VelViento100m_2</th>
      <th>VelViento80m_1</th>
      <th>VelViento80m_2</th>
      <th>VelViento60m</th>
      <th>DirViento60m</th>
      <th>DirViento100m</th>
      <th>DirViento80m</th>
      <th>Presion</th>
      <th>Humedad</th>
      <th>Temp100m</th>
      <th>Temp21m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-01-01 00:00:00</td>
      <td>16.060860</td>
      <td>15.830104</td>
      <td>15.145418</td>
      <td>15.125038</td>
      <td>14.300989</td>
      <td>61.98</td>
      <td>61.08</td>
      <td>61.21</td>
      <td>1005.963541</td>
      <td>75.042725</td>
      <td>26.922913</td>
      <td>26.707773</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-01-01 00:10:00</td>
      <td>16.156927</td>
      <td>15.972642</td>
      <td>15.290614</td>
      <td>15.352352</td>
      <td>14.533556</td>
      <td>62.29</td>
      <td>61.08</td>
      <td>61.49</td>
      <td>1005.795867</td>
      <td>73.509216</td>
      <td>27.006836</td>
      <td>26.772633</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-01-01 00:20:00</td>
      <td>16.473571</td>
      <td>16.287375</td>
      <td>15.599149</td>
      <td>15.562022</td>
      <td>14.808378</td>
      <td>61.18</td>
      <td>60.42</td>
      <td>60.65</td>
      <td>1005.739976</td>
      <td>72.914124</td>
      <td>26.991577</td>
      <td>26.772633</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-01-01 00:30:00</td>
      <td>16.660009</td>
      <td>16.451707</td>
      <td>15.801446</td>
      <td>15.779687</td>
      <td>15.170287</td>
      <td>62.20</td>
      <td>60.88</td>
      <td>61.19</td>
      <td>1005.684085</td>
      <td>73.165894</td>
      <td>26.877136</td>
      <td>26.659982</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-01-01 00:40:00</td>
      <td>16.519613</td>
      <td>16.353678</td>
      <td>15.851963</td>
      <td>15.749131</td>
      <td>14.927282</td>
      <td>61.26</td>
      <td>59.99</td>
      <td>60.26</td>
      <td>1005.609563</td>
      <td>73.791504</td>
      <td>26.770325</td>
      <td>26.601949</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fecha</th>
      <th>VelViento100m_1</th>
      <th>VelViento100m_2</th>
      <th>VelViento80m_1</th>
      <th>VelViento80m_2</th>
      <th>VelViento60m</th>
      <th>DirViento60m</th>
      <th>DirViento100m</th>
      <th>DirViento80m</th>
      <th>Presion</th>
      <th>Humedad</th>
      <th>Temp100m</th>
      <th>Temp21m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19003</th>
      <td>2022-05-16 23:10:00</td>
      <td>5.667995</td>
      <td>5.628245</td>
      <td>5.501305</td>
      <td>5.550207</td>
      <td>5.388042</td>
      <td>60.80</td>
      <td>57.36</td>
      <td>58.61</td>
      <td>1007.863847</td>
      <td>92.353821</td>
      <td>27.701111</td>
      <td>27.636290</td>
    </tr>
    <tr>
      <th>19004</th>
      <td>2022-05-16 23:20:00</td>
      <td>5.523755</td>
      <td>5.470902</td>
      <td>5.401929</td>
      <td>5.417549</td>
      <td>5.340636</td>
      <td>58.95</td>
      <td>56.91</td>
      <td>58.10</td>
      <td>1007.677543</td>
      <td>92.506409</td>
      <td>27.662964</td>
      <td>27.619222</td>
    </tr>
    <tr>
      <th>19005</th>
      <td>2022-05-16 23:30:00</td>
      <td>5.627141</td>
      <td>5.566218</td>
      <td>5.544223</td>
      <td>5.575709</td>
      <td>5.540006</td>
      <td>58.45</td>
      <td>55.67</td>
      <td>56.47</td>
      <td>1007.547129</td>
      <td>92.498779</td>
      <td>27.632446</td>
      <td>27.591912</td>
    </tr>
    <tr>
      <th>19006</th>
      <td>2022-05-16 23:40:00</td>
      <td>5.590224</td>
      <td>5.554034</td>
      <td>5.480490</td>
      <td>5.488771</td>
      <td>5.404135</td>
      <td>54.54</td>
      <td>52.24</td>
      <td>53.25</td>
      <td>1007.304934</td>
      <td>92.544556</td>
      <td>27.624817</td>
      <td>27.585085</td>
    </tr>
    <tr>
      <th>19007</th>
      <td>2022-05-16 23:50:00</td>
      <td>5.825946</td>
      <td>5.788715</td>
      <td>5.683985</td>
      <td>5.699682</td>
      <td>5.602768</td>
      <td>56.87</td>
      <td>53.48</td>
      <td>55.07</td>
      <td>1007.230412</td>
      <td>92.613220</td>
      <td>27.609558</td>
      <td>27.564603</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(19008, 13)
</pre></div>
</div>
</div>
</div>
<p>El conjunto de datos cuenta con <strong>13</strong> variables y <strong>19008</strong> observaciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VelViento100m_1</th>
      <th>VelViento100m_2</th>
      <th>VelViento80m_1</th>
      <th>VelViento80m_2</th>
      <th>VelViento60m</th>
      <th>DirViento60m</th>
      <th>DirViento100m</th>
      <th>DirViento80m</th>
      <th>Presion</th>
      <th>Humedad</th>
      <th>Temp100m</th>
      <th>Temp21m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
      <td>19008.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>12.342915</td>
      <td>12.208528</td>
      <td>11.964910</td>
      <td>11.961529</td>
      <td>11.636214</td>
      <td>66.866064</td>
      <td>65.645194</td>
      <td>65.904410</td>
      <td>1006.196902</td>
      <td>84.469273</td>
      <td>26.265028</td>
      <td>26.486346</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.433466</td>
      <td>4.385033</td>
      <td>4.268770</td>
      <td>4.258439</td>
      <td>4.103487</td>
      <td>47.736005</td>
      <td>48.149888</td>
      <td>47.909614</td>
      <td>1.823613</td>
      <td>4.292172</td>
      <td>0.837681</td>
      <td>0.946633</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.251334</td>
      <td>0.225181</td>
      <td>0.236040</td>
      <td>0.255526</td>
      <td>0.292860</td>
      <td>0.230000</td>
      <td>0.000000</td>
      <td>0.030000</td>
      <td>1001.417712</td>
      <td>63.072205</td>
      <td>23.710938</td>
      <td>22.700129</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>9.837316</td>
      <td>9.736328</td>
      <td>9.612626</td>
      <td>9.624122</td>
      <td>9.451099</td>
      <td>48.840000</td>
      <td>47.840000</td>
      <td>47.890000</td>
      <td>1004.901606</td>
      <td>81.634521</td>
      <td>25.709839</td>
      <td>25.820220</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>12.963534</td>
      <td>12.826116</td>
      <td>12.574976</td>
      <td>12.572975</td>
      <td>12.247453</td>
      <td>56.420000</td>
      <td>55.230000</td>
      <td>55.525000</td>
      <td>1006.112585</td>
      <td>84.625244</td>
      <td>26.060791</td>
      <td>26.323735</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>15.570065</td>
      <td>15.395811</td>
      <td>15.044143</td>
      <td>15.026889</td>
      <td>14.568282</td>
      <td>64.360000</td>
      <td>62.900000</td>
      <td>63.312500</td>
      <td>1007.421374</td>
      <td>87.646484</td>
      <td>26.571960</td>
      <td>26.984280</td>
    </tr>
    <tr>
      <th>max</th>
      <td>22.301553</td>
      <td>22.027242</td>
      <td>21.730798</td>
      <td>21.769775</td>
      <td>21.140790</td>
      <td>359.900000</td>
      <td>359.950000</td>
      <td>359.890000</td>
      <td>1012.428307</td>
      <td>94.093323</td>
      <td>33.903809</td>
      <td>34.596755</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A partir del análisis estadístico de las variables presentadas en el resumen descriptivo, se puede observar que no hay valores erróneos en los datos de velocidad del viento, presión atmosférica, humedad relativa, temperatura y dirección del viento. Esto se debe a que se han aplicado previamente criterios específicos de limpieza para garantizar la calidad de la base de datos.</p>
<p>Para identificar y eliminar los datos erróneos, se emplearon las siguientes reglas: en la <strong>velocidad del viento</strong>, cualquier valor menor a 0.5 m/s que permanezca fijo en el tiempo se considera un error. Para la <strong>presión atmosférica</strong>, valores por debajo de 980 hPa se identifican como erróneos. En el caso de la <strong>humedad relativa</strong>, valores menores a 60% son inválidos, y para la <strong>temperatura</strong>, cualquier valor inferior a 20°C también es considerado un error, con la particularidad de que los errores en humedad y temperatura suelen coincidir en el tiempo.</p>
<p>Por otro lado, la <strong>dirección del viento</strong> presenta desafíos adicionales en su evaluación, ya que es una variable circular en la que 360° equivale a 0°. Por lo tanto, valores altos no son necesariamente erróneos ni atípicos; en su lugar, los errores en esta variable se detectan cuando la serie permanece fija en un valor específico de manera prolongada.</p>
<p>Con estos filtros aplicados, los valores descriptivos en el resumen indican que la base de datos está limpia y lista para desarrollar y aplicar modelos de regresión para cada una de las variables de velocidad del viento a diferentes alturas.</p>
</section>
</section>
<section id="id1">
<h2><strong>Modelos de regresión</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>En esta sección, abordamos la implementación de los modelos de regresión. Nuestro objetivo principal es predecir la velocidad del viento, y para ello hemos identificado cinco variables objetivo, las cuales corresponden a las velocidades del viento medidas a diferentes alturas y con distintos sensores. Para modelar estas variables, aplicaremos los ocho modelos de regresión seleccionados durante el semestre académico en la clase de Machine Learning: <strong>Regresión K-NN, Regresión Ridge, Regresión Lasso, Regresión Lineal, Árboles de decisión para regresión, Random Forest, XGBoost y SVR</strong>.</p>
<section id="metricas-de-evaluacion">
<h3><strong>Métricas de evaluación</strong><a class="headerlink" href="#metricas-de-evaluacion" title="Link to this heading">#</a></h3>
<p>En este proyecto, utilizaremos varias métricas de desempeño para evaluar y comparar la capacidad predictiva de los modelos implementados. Estas métricas son las siguientes:</p>
<ol class="arabic simple">
<li><p><strong>Mean Absolute Percentage Error (MAPE):</strong> Mide el error porcentual promedio entre los valores predichos y los valores reales. Es útil para interpretar el desempeño del modelo en términos relativos y facilita la comparación entre diferentes modelos.</p></li>
<li><p><strong>Mean Absolute Error (MAE):</strong> Calcula el promedio del error absoluto entre los valores predichos y los reales. Es una métrica que refleja el error promedio sin importar su dirección (positivo o negativo).</p></li>
<li><p><strong>Mean Squared Error (MSE):</strong> Promedia el cuadrado de los errores entre los valores reales y predichos. Penaliza más severamente los errores grandes, lo que la hace útil para detectar grandes discrepancias en las predicciones.</p></li>
<li><p><strong>Root Mean Squared Error (RMSE):</strong> Es la raíz cuadrada del MSE y tiene la misma unidad que los datos originales. Permite interpretar fácilmente el nivel promedio de error en las predicciones.</p></li>
<li><p><strong>Coeficiente de Determinación (R²):</strong> Evalúa qué proporción de la variabilidad en los datos reales es explicada por el modelo. Un valor cercano a 1 indica un modelo altamente explicativo.</p></li>
<li><p><strong>Ljung-Box p-value:</strong> Verifica si los residuos del modelo son independientes y no están correlacionados.</p>
<ul class="simple">
<li><p><strong>Hipótesis:</strong></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(H_0:\)</span> Los residuos no están autocorrelacionados (independencia).</p></li>
<li><p><span class="math notranslate nohighlight">\(H_1:\)</span> Los residuos están autocorrelacionados.</p></li>
</ul>
</li>
<li><p><strong>Interpretación:</strong> Un valor p mayor a 0.05 indica que no hay evidencia de correlación entre los residuos, lo que sugiere independencia.</p></li>
</ul>
</li>
<li><p><strong>Jarque-Bera p-value:</strong> Evalúa si los residuos siguen una distribución normal.</p>
<ul class="simple">
<li><p><strong>Hipótesis:</strong></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(H_0:\)</span> Los residuos tienen una distribución normal.</p></li>
<li><p><span class="math notranslate nohighlight">\(H_1:\)</span> Los residuos no tienen una distribución normal.</p></li>
</ul>
</li>
<li><p><strong>Interpretación:</strong> Un valor p mayor a 0.05 indica que no hay evidencia suficiente para rechazar la normalidad de los residuos.</p></li>
</ul>
</li>
</ol>
<p>En este proyecto, nuestra <strong>métrica objetivo principal será el R² y el RMSE</strong>, ya que estas permiten evaluar, respectivamente, qué tanta variabilidad de los datos reales puede ser explicada por el modelo y el nivel promedio de error de las predicciones. Estas métricas son especialmente útiles para analizar el desempeño predictivo de los modelos y compararlos en términos de precisión y capacidad explicativa.</p>
</section>
</section>
<section id="metodos-para-realizar-las-graficas">
<h2><strong>Métodos para realizar las gráficas</strong><a class="headerlink" href="#metodos-para-realizar-las-graficas" title="Link to this heading">#</a></h2>
<p>En esta sección, se desarrollan métodos para generar gráficas de las predicciones y los residuos, con el propósito de optimizar el código para cada uno de los modelos a implementar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grafica</span><span class="p">(</span><span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">):</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">n_display</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="c1"># Gráfico del conjunto de entrenamiento</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_display</span><span class="p">),</span> <span class="n">y_train</span><span class="p">[:</span><span class="n">n_display</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad original&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_display</span><span class="p">),</span> <span class="n">y_train_pred</span><span class="p">[:</span><span class="n">n_display</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad predicha&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00B2EE&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocidad del viento&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_train</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1"># Gráfico del conjunto de prueba</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_display</span><span class="p">),</span> <span class="n">y_test</span><span class="p">[:</span><span class="n">n_display</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad original&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_display</span><span class="p">),</span> <span class="n">y_test_pred</span><span class="p">[:</span><span class="n">n_display</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocidad predicha&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00B2EE&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Índice&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocidad del viento&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2"> (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2_test</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grafica_residuos</span><span class="p">(</span><span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">residuos</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Histograma de los residuos</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograma de los Residuos (</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Valor del Residuo&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

    <span class="c1"># Gráfico de autocorrelación</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00008B&#39;</span><span class="p">,</span> <span class="n">vlines_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#00008B&#39;</span><span class="p">},</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Autocorrelación de los Residuos (</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="metodos-para-los-modelos-de-regresion">
<h2><strong>Métodos para los modelos de regresión</strong><a class="headerlink" href="#metodos-para-los-modelos-de-regresion" title="Link to this heading">#</a></h2>
<p>A continuación se presenta un método para cada uno de los modelos de regresión, con el objetivo de reducir la cantidad de código repetido. Estos métodos se encargan de encontrar los mejores hiperparámetros, evaluar los modelos, calcular las métricas y generar las predicciones, utilizando los conjuntos de datos <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>, <code class="docutils literal notranslate"><span class="pre">X_test</span></code> y <code class="docutils literal notranslate"><span class="pre">y_test</span></code>.</p>
<p>Este proceso se aplica a cada uno de los modelos de regresión, incluyendo KNN, regresión lineal, Ridge, Lasso, Árbol de decisión regresor, Random Forest Regressor, XGBoost y SVR, garantizando así un flujo de trabajo consistente y eficiente para cada técnica.</p>
<section id="knn-regressor">
<h3><strong>KNN Regressor</strong><a class="headerlink" href="#knn-regressor" title="Link to this heading">#</a></h3>
<p>El algoritmo <strong>KNN Regressor</strong> predice el valor objetivo de una muestra basándose en el promedio de los valores de sus <strong>K vecinos más cercanos</strong>, determinados según una métrica de distancia. Es un método no paramétrico, ideal para problemas no lineales, pero sensible a datos ruidosos y alta dimensionalidad.</p>
<p><strong>Hiperparámetros:</strong></p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code></strong>:</p>
<ul class="simple">
<li><p>Número de vecinos considerados para la predicción.</p></li>
<li><p>Valores bajos pueden llevar a sobreajuste; valores altos pueden causar subajuste.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">p</span></code></strong>:</p>
<ul class="simple">
<li><p>Define la métrica de distancia:</p>
<ul>
<li><p><strong>1</strong>: Distancia Manhattan.</p></li>
<li><p><strong>2</strong>: Distancia Euclidiana (por defecto).</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<p>Ambos parámetros afectan la precisión y el comportamiento del modelo, por lo que deben ajustarse cuidadosamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">param_grid_knn</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># Normas de distancia: Manhattan (1), Euclidiana (2)</span>
    <span class="p">}</span>
    
    <span class="n">modelo</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
    <span class="n">grid_knn</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">param_grid_knn</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
    
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred_knn</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_knn</span>
    
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_knn</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">)</span>
    
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;K-NN Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;K-NN Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_knn</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ridge-regression">
<h3><strong>Ridge Regression</strong><a class="headerlink" href="#ridge-regression" title="Link to this heading">#</a></h3>
<p>Ridge Regression es una técnica de regresión lineal regularizada que añade una penalización al modelo en función del tamaño de los coeficientes. Esto evita problemas de sobreajuste, especialmente en conjuntos de datos donde las variables están altamente correlacionadas (multicolinealidad). La penalización está controlada por un hiperparámetro denominado <code class="docutils literal notranslate"><span class="pre">alpha</span></code>.</p>
<p><strong>Hiperparámetros:</strong></p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">alpha</span></code>:</strong></p>
<ul class="simple">
<li><p>Controla la fuerza de la regularización.</p></li>
<li><p>Valores pequeños de <code class="docutils literal notranslate"><span class="pre">alpha</span></code> (cercanos a 0) hacen que el modelo se comporte como una regresión lineal estándar.</p></li>
<li><p>Valores altos aplican una mayor penalización, lo que reduce el tamaño de los coeficientes y hace que el modelo sea más robusto frente al sobreajuste.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">param_grid_ridge</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">modelo</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>

    <span class="n">grid_ridge</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">param_grid_ridge</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred_ridge</span> <span class="o">=</span> <span class="n">grid_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_ridge</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_ridge</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">)</span>

    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>

    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_ridge</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lasso-regression">
<h3><strong>Lasso Regression</strong><a class="headerlink" href="#lasso-regression" title="Link to this heading">#</a></h3>
<p>Es una técnica de regresión lineal regularizada que utiliza la penalización L1. Esta penalización no solo reduce el tamaño de los coeficientes, sino que también puede llevarlos a cero, realizando una selección automática de variables. Es particularmente útil cuando se busca un modelo interpretable eliminando variables irrelevantes.</p>
<p><strong>Hiperparámetros:</strong></p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">alpha</span></code>:</strong></p>
<ul class="simple">
<li><p>Controla la fuerza de la regularización L1.</p></li>
<li><p>Valores pequeños de <code class="docutils literal notranslate"><span class="pre">alpha</span></code> permiten que los coeficientes sean más grandes y el modelo se asemeje a una regresión lineal estándar.</p></li>
<li><p>Valores altos de <code class="docutils literal notranslate"><span class="pre">alpha</span></code> aplican mayor penalización, eliminando coeficientes irrelevantes (reduciéndolos a cero) para simplificar el modelo.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">param_grid_lasso</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">modelo</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

    <span class="n">grid_lasso</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">param_grid_lasso</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred_lasso</span> <span class="o">=</span> <span class="n">grid_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_lasso</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_lasso</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">)</span>

    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Lasso Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>

    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Lasso Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_lasso</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="linear-regression">
<h3><strong>Linear Regression</strong><a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h3>
<p>La Regresión Lineal es el modelo más simple y básico para predecir una variable dependiente continua basada en una o más variables independientes. Busca encontrar una relación lineal entre las variables ajustando un hiperplano que minimice la suma de los errores cuadrados entre las predicciones y los valores reales.</p>
<p><strong>Hiperparámetros:</strong>
La Regresión Lineal no tiene hiperparámetros ajustables. Su comportamiento depende únicamente de los datos de entrenamiento y no aplica regularización ni ajustes adicionales, lo que la hace un modelo sencillo pero limitado en problemas con multicolinealidad o sobreajuste.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    
    <span class="n">modelo</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>


    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Linear Regression&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="decision-tree-regressor">
<h3><strong>Decision Tree Regressor</strong><a class="headerlink" href="#decision-tree-regressor" title="Link to this heading">#</a></h3>
<p>El Decision Tree Regressor es un modelo basado en árboles que divide los datos en subconjuntos más pequeños para capturar relaciones complejas entre variables. Es interpretativo y flexible, pero puede sobreajustar si no se regulariza.</p>
<p><strong>Hiperparámetros:</strong></p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">max_depth</span></code>:</strong> Profundidad máxima del árbol. Controla la complejidad del modelo para evitar sobreajuste.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">min_samples_split</span></code>:</strong> Número mínimo de muestras necesarias para dividir un nodo. Valores más altos simplifican el modelo.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">min_samples_leaf</span></code>:</strong> Número mínimo de muestras en cada nodo hoja. Valores más altos generan árboles más simples.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">param_grid_tree</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
        <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
        <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">modelo</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">()</span>

    <span class="n">grid_tree</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">param_grid_tree</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred_tree</span> <span class="o">=</span> <span class="n">grid_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_tree</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_tree</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_tree</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_tree</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_tree</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_tree</span><span class="p">)</span>

    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Decision Tree Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>

    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Decision Tree Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_tree</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="random-forest-regressor">
<h3><strong>Random Forest Regressor</strong><a class="headerlink" href="#random-forest-regressor" title="Link to this heading">#</a></h3>
<p>El Random Forest Regressor es un modelo de ensamble basado en múltiples árboles de decisión. Combina las predicciones de varios árboles para mejorar la precisión y reducir el sobreajuste.</p>
<p><strong>Hiperparámetros:</strong></p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">n_estimators</span></code>:</strong> Número de árboles en el bosque. Más árboles generalmente mejoran la estabilidad del modelo.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">max_depth</span></code>:</strong> Profundidad máxima de los árboles. Controla la complejidad del modelo y previene el sobreajuste.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">param_grid_rf</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>  <span class="c1"># Valores entre 10 y 100 en pasos de 10</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="n">modelo</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>

    <span class="n">grid_rf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span><span class="n">param_grid_rf</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">grid_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_rf</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_rf</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">)</span>

    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Random Forest Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>

    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Random Forest Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_rf</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="xgboost-regressor">
<h3><strong>XGBoost Regressor</strong><a class="headerlink" href="#xgboost-regressor" title="Link to this heading">#</a></h3>
<p>XGBoost (eXtreme Gradient Boosting) es un modelo de ensamble basado en árboles de decisión que utiliza técnicas de boosting para mejorar iterativamente el rendimiento del modelo. Es conocido por su eficiencia, velocidad y rendimiento en problemas de regresión y clasificación.</p>
<p><strong>Hiperparámetros:</strong></p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">n_estimators</span></code>:</strong> Número de árboles que se construirán en el modelo. Incrementar el número de árboles puede mejorar el rendimiento, pero también incrementa el tiempo de entrenamiento.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">max_depth</span></code>:</strong> Profundidad máxima de los árboles. Controla la complejidad del modelo, evitando sobreajuste al limitar el crecimiento de los árboles.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">learning_rate</span></code>:</strong> Tasa de aprendizaje que ajusta cuánto contribuye cada árbol a la predicción final. Valores más bajos requieren más árboles para converger, pero pueden mejorar la generalización.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">param_grid_xgb</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>  <span class="c1"># Valores entre 10 y 100 en pasos de 10</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>              <span class="c1"># Valores de profundidad del árbol</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>  <span class="c1"># Tasa de aprendizaje</span>
    <span class="p">}</span>

    <span class="n">modelo</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>

    <span class="n">grid_xgb</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">param_grid_xgb</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred_xgb</span> <span class="o">=</span> <span class="n">grid_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_xgb</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_xgb</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">)</span>

    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>

    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost Regressor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_train_pred</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_xgb</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="svr-support-vector-regression">
<h3><strong>SVR (Support Vector Regression)</strong><a class="headerlink" href="#svr-support-vector-regression" title="Link to this heading">#</a></h3>
<p>El modelo de Support Vector Regression (SVR) utiliza principios de los Support Vector Machines (SVM) para realizar predicciones en problemas de regresión. Busca encontrar una función que tenga un margen máximo (tolerancia al error) alrededor de los valores predichos, asegurando un modelo robusto y generalizable.</p>
<p><strong>Hiperparámetros:</strong></p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">kernel</span></code>:</strong> Define la función del kernel utilizada para transformar los datos en un espacio de características más alto. En este caso, se utiliza <code class="docutils literal notranslate"><span class="pre">'rbf'</span></code> (función de base radial), que es ideal para modelar relaciones no lineales.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">C</span></code>:</strong> Parámetro de penalización. Controla el equilibrio entre minimizar el error de entrenamiento y lograr una buena generalización. Valores más altos permiten que el modelo se ajuste más a los datos de entrenamiento.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">gamma</span></code>:</strong> Coeficiente del kernel. Controla la influencia de un solo punto de datos. Valores pequeños implican que los puntos alejados tienen un impacto significativo, mientras que valores grandes restringen la influencia a puntos cercanos.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">resultados_graficos</span><span class="p">):</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span>       <span class="c1"># Selección de funciones kernel</span>
        <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>           <span class="c1"># Parámetro de penalización</span>
        <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">]</span>        <span class="c1"># Coeficiente del kernel</span>
    <span class="p">}</span>

    <span class="n">modelo</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">()</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>

    
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

    
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="n">ljung_box_p_value</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">return_df</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque_bera_p_value</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;SVR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarque_bera_p_value</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de ejecución (s)&#39;</span><span class="p">:</span> <span class="n">execution_time</span>
    <span class="p">})</span>
   
    
    <span class="n">resultados_graficos</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;nombre_modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;SVR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
        <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_train</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
        <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
        <span class="s1">&#39;residuos&#39;</span><span class="p">:</span> <span class="n">residuals</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="aspectos-importantes">
<h3><strong>Aspectos importantes</strong><a class="headerlink" href="#aspectos-importantes" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>División del conjunto de datos</strong>: El conjunto se particiona en dos subconjuntos: un 70% destinado al entrenamiento y un 30% reservado para la prueba.</p></li>
<li><p><strong>Orden de los datos</strong>: La partición se realiza sin conservar el orden cronológico, ya que el conjunto de datos y las variables no presentan tendencias temporales relevantes. Mantener el orden cronológico podría introducir sesgos y afectar negativamente el desempeño del modelo, por lo que se opta por un particionamiento aleatorio para garantizar una mejor capacidad predictiva.</p></li>
</ol>
<p>Para cada una de las alturas de la velocidad del viento, se aplicará el siguiente procedimiento:</p>
<ol class="arabic simple">
<li><p><strong>Separación del Conjunto de Datos</strong>:</p>
<ul class="simple">
<li><p>Separamos el conjunto de datos en <code class="docutils literal notranslate"><span class="pre">X{i}</span></code>, que contiene las variables explicativas relacionadas con la altura <code class="docutils literal notranslate"><span class="pre">i</span></code>, y <code class="docutils literal notranslate"><span class="pre">y{i}</span></code>, que representa la velocidad del viento a esa altura. Cabe recordar que existen cinco alturas a evaluar: 100 m (sensor 1), 100 m (sensor 2), 80 m (sensor 1), 80 m (sensor 2), y 60 m.</p></li>
</ul>
</li>
<li><p><strong>División en Conjuntos de Entrenamiento y Prueba</strong>:</p>
<ul class="simple">
<li><p>Utilizando <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code>, dividimos los datos en <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">X_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code> y <code class="docutils literal notranslate"><span class="pre">y_test</span></code>.</p></li>
</ul>
</li>
<li><p><strong>Aplicación de Modelos de Regresión</strong>:</p>
<ul class="simple">
<li><p>Se aplican los modelos, generando una tabla que contiene las métricas de evaluación y los valores de los residuos.</p></li>
</ul>
</li>
<li><p><strong>Visualización de Resultados</strong>:</p>
<ul class="simple">
<li><p>Se grafican las predicciones contra los valores reales, tanto en el conjunto de entrenamiento como en el de prueba.</p></li>
<li><p>Se generan gráficos para evaluar la normalidad de los residuos (histograma de normalidad) y su autocorrelación.</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="modelo-1-wind-speed-100-metros-sensor-1">
<h2><strong>Modelo 1: Wind speed 100 metros (Sensor 1)</strong><a class="headerlink" href="#modelo-1-wind-speed-100-metros-sensor-1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento80m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos1</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados1</span><span class="p">,</span> <span class="n">resultados_graficos1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados1</span><span class="p">)</span>
<span class="n">resultados1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R²</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
      <th>Tiempo de ejecución (s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN Regressor</td>
      <td>16.915143</td>
      <td>1.309740</td>
      <td>3.396062</td>
      <td>1.842841</td>
      <td>0.821791</td>
      <td>0.973834</td>
      <td>0.000000e+00</td>
      <td>4.880810</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>31.092871</td>
      <td>2.332523</td>
      <td>8.717321</td>
      <td>2.952511</td>
      <td>0.542558</td>
      <td>0.673576</td>
      <td>1.529324e-64</td>
      <td>0.370451</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>31.086646</td>
      <td>2.333257</td>
      <td>8.719212</td>
      <td>2.952831</td>
      <td>0.542459</td>
      <td>0.672128</td>
      <td>1.005781e-63</td>
      <td>0.483886</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>31.084904</td>
      <td>2.333242</td>
      <td>8.719288</td>
      <td>2.952844</td>
      <td>0.542455</td>
      <td>0.672154</td>
      <td>9.826798e-64</td>
      <td>0.011860</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree Regressor</td>
      <td>14.921594</td>
      <td>1.286196</td>
      <td>3.766052</td>
      <td>1.940632</td>
      <td>0.802376</td>
      <td>0.371857</td>
      <td>0.000000e+00</td>
      <td>369.826796</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest Regressor</td>
      <td>12.227584</td>
      <td>1.019278</td>
      <td>2.102635</td>
      <td>1.450046</td>
      <td>0.889664</td>
      <td>0.699450</td>
      <td>0.000000e+00</td>
      <td>780.819043</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost Regressor</td>
      <td>11.475852</td>
      <td>0.972034</td>
      <td>2.008381</td>
      <td>1.417173</td>
      <td>0.894610</td>
      <td>0.402368</td>
      <td>0.000000e+00</td>
      <td>2308.316762</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>21.782665</td>
      <td>1.536131</td>
      <td>4.331848</td>
      <td>2.081309</td>
      <td>0.772686</td>
      <td>0.925772</td>
      <td>3.915347e-207</td>
      <td>587.211124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados1</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;resultados1.pkl&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos1.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">resultados_graficos1</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos1.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">resultados_graficos1_cargado</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos1</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/56b44be4dd55b91d758c1ed019d4d64ba8bb160f39c01854d3210ac47dd2ad97.png" src="_images/56b44be4dd55b91d758c1ed019d4d64ba8bb160f39c01854d3210ac47dd2ad97.png" />
<img alt="_images/6540991a00c24ae88ed6e66423e899485c096a662577ac387961707e17360230.png" src="_images/6540991a00c24ae88ed6e66423e899485c096a662577ac387961707e17360230.png" />
<img alt="_images/829c279c6f03190035b20275efd7b402311e7e34da250e25f4fac1ecad4ea833.png" src="_images/829c279c6f03190035b20275efd7b402311e7e34da250e25f4fac1ecad4ea833.png" />
<img alt="_images/602c36cdd450fcd714c5a72a41f49087820b9926b26d301a8aa567e85db67b76.png" src="_images/602c36cdd450fcd714c5a72a41f49087820b9926b26d301a8aa567e85db67b76.png" />
<img alt="_images/503f20a9ff2176f22241fd8f706abb229e4684ff8a90e680dae5e2967a48c897.png" src="_images/503f20a9ff2176f22241fd8f706abb229e4684ff8a90e680dae5e2967a48c897.png" />
<img alt="_images/e8732e1ec4a9a25f3e768da386871a89f0a4f962884fef8f770af7011a3ae849.png" src="_images/e8732e1ec4a9a25f3e768da386871a89f0a4f962884fef8f770af7011a3ae849.png" />
<img alt="_images/0f363a62d3778719f64c7462ccc20cf453d485edd291e0627b2c0327afb1bb94.png" src="_images/0f363a62d3778719f64c7462ccc20cf453d485edd291e0627b2c0327afb1bb94.png" />
<img alt="_images/c124c9c08708ec93fc32fb9751315fd99579894d76996a7538dec93d766898d4.png" src="_images/c124c9c08708ec93fc32fb9751315fd99579894d76996a7538dec93d766898d4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos1</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de757a841707bfdb75b9ab037f9950122a0d2e7874edfa70b00ca60be0c6d445.png" src="_images/de757a841707bfdb75b9ab037f9950122a0d2e7874edfa70b00ca60be0c6d445.png" />
<img alt="_images/36a409f8f6fe82216982a02c00deb7344f7a778afacf5b324c2725381f944c0d.png" src="_images/36a409f8f6fe82216982a02c00deb7344f7a778afacf5b324c2725381f944c0d.png" />
<img alt="_images/62e15dc2ef46a13170e4a215fdd72484858d0e55da66b08ee982678a695cb7e7.png" src="_images/62e15dc2ef46a13170e4a215fdd72484858d0e55da66b08ee982678a695cb7e7.png" />
<img alt="_images/b4d7bbbafd27e4d8cd7a0a19e13681667726e518dfd97fdc28e75360f0df6554.png" src="_images/b4d7bbbafd27e4d8cd7a0a19e13681667726e518dfd97fdc28e75360f0df6554.png" />
<img alt="_images/3d5d023cdb9dffe96610886e8a9469cd1bf104b6e768db06c4f207ed847432d3.png" src="_images/3d5d023cdb9dffe96610886e8a9469cd1bf104b6e768db06c4f207ed847432d3.png" />
<img alt="_images/694a69e3a5a5016c9cef9a6438ab7e739554adb91c77e91824ebc4da7ae0eda3.png" src="_images/694a69e3a5a5016c9cef9a6438ab7e739554adb91c77e91824ebc4da7ae0eda3.png" />
<img alt="_images/ffd576da7eb1249b7c806774f3e026f3a6a1788da2a08f05aacdcab788d0ddcc.png" src="_images/ffd576da7eb1249b7c806774f3e026f3a6a1788da2a08f05aacdcab788d0ddcc.png" />
<img alt="_images/a908b9c84a21cd2274c2f6176977f48f1e05fb2dc9c8fcff0bb93f95d9ab7b91.png" src="_images/a908b9c84a21cd2274c2f6176977f48f1e05fb2dc9c8fcff0bb93f95d9ab7b91.png" />
</div>
</div>
<section id="interpretacion-de-los-resultados">
<h3><strong>Interpretación de los resultados</strong><a class="headerlink" href="#interpretacion-de-los-resultados" title="Link to this heading">#</a></h3>
<p>Los resultados obtenidos en la tabla reflejan un análisis exhaustivo de los diferentes modelos de regresión evaluados para predecir la velocidad del viento a 100 metros de altura utilizando los datos del <strong>Sensor 1</strong>, correspondiente a la dirección <strong>NW</strong>. Entre todos los modelos, el <strong>XGBoost Regressor</strong> destaca como el más preciso, con el menor error porcentual medio absoluto (<strong>MAPE = 11.4758%</strong>) y la menor raíz del error cuadrático medio (<strong>RMSE = 1.4717</strong>), además de un coeficiente de determinación (<strong>R² = 0.8936</strong>) que indica que explica el 89.36% de la variabilidad en los datos. Otros modelos como el <strong>Random Forest Regressor</strong> y el <strong>Decision Tree Regressor</strong> también muestran un desempeño competitivo, evidenciando su capacidad para capturar relaciones no lineales en los datos. En contraste, los modelos lineales como <strong>Ridge Regression</strong>, <strong>Lasso Regression</strong>, y <strong>Linear Regression</strong> presentan un desempeño limitado, con valores de <strong>R²</strong> cercanos a 0.54, lo que sugiere que explican menos de la mitad de la variabilidad.</p>
<p>En cuanto a los residuos de los modelos, las pruebas estadísticas, como el <strong>p-value de Jarque-Bera</strong>, indican que estos no siguen una distribución normal, pese a que en las gráficas de los residuos se observa una distribución visualmente cercana a la normalidad. Esta discrepancia se explica por la presencia de múltiples datos atípicos en las variables meteorológicas, los cuales no fueron imputados ni eliminados ya que representan eventos reales y son inherentes a las mediciones de este tipo de datos. Adicionalmente, la prueba de <strong>Ljung-Box</strong> confirma la independencia de los residuos al mostrar valores p elevados, indicando que no existe una autocorrelación significativa en ellos. Esto respalda que los modelos están capturando correctamente las relaciones temporales, si bien la presencia de datos extremos introduce cierta complejidad en los análisis.</p>
<p>Finalmente, es importante mencionar los tiempos de ejecución, donde modelos como el <strong>XGBoost Regressor</strong> y el <strong>Random Forest Regressor</strong> requieren tiempos significativamente mayores debido a su alta capacidad predictiva y complejidad computacional, mientras que los modelos lineales presentan tiempos mucho menores. En conjunto, estos resultados resaltan al <strong>XGBoost Regressor</strong> como el modelo más robusto y adecuado para predecir la velocidad del viento a 100 metros para el <strong>Sensor 1 (NW)</strong>, logrando un balance entre precisión, capacidad explicativa y manejo de los datos meteorológicos reales.</p>
</section>
</section>
<section id="modelo-2-wind-speed-100-metros-sensor-2">
<h2><strong>Modelo 2: Wind speed 100 metros (Sensor 2)</strong><a class="headerlink" href="#modelo-2-wind-speed-100-metros-sensor-2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento80m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos2</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados2</span><span class="p">,</span> <span class="n">resultados_graficos2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados2</span><span class="p">)</span>
<span class="n">resultados2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R²</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
      <th>Tiempo de ejecución (s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN Regressor</td>
      <td>17.156660</td>
      <td>1.297249</td>
      <td>3.333846</td>
      <td>1.825882</td>
      <td>0.821263</td>
      <td>0.977747</td>
      <td>0.000000e+00</td>
      <td>3.457123</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>31.498183</td>
      <td>2.307029</td>
      <td>8.533583</td>
      <td>2.921230</td>
      <td>0.542491</td>
      <td>0.688785</td>
      <td>7.792992e-66</td>
      <td>0.251976</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>31.492038</td>
      <td>2.307766</td>
      <td>8.535439</td>
      <td>2.921547</td>
      <td>0.542391</td>
      <td>0.687331</td>
      <td>5.271714e-65</td>
      <td>0.370305</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>31.490396</td>
      <td>2.307756</td>
      <td>8.535517</td>
      <td>2.921561</td>
      <td>0.542387</td>
      <td>0.687359</td>
      <td>5.155424e-65</td>
      <td>0.010072</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree Regressor</td>
      <td>14.943384</td>
      <td>1.284665</td>
      <td>3.652780</td>
      <td>1.911225</td>
      <td>0.804164</td>
      <td>0.750433</td>
      <td>0.000000e+00</td>
      <td>351.452217</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest Regressor</td>
      <td>12.393786</td>
      <td>1.008061</td>
      <td>2.045976</td>
      <td>1.430376</td>
      <td>0.890309</td>
      <td>0.782362</td>
      <td>0.000000e+00</td>
      <td>587.976190</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost Regressor</td>
      <td>11.642434</td>
      <td>0.961439</td>
      <td>1.966114</td>
      <td>1.402182</td>
      <td>0.894591</td>
      <td>0.442446</td>
      <td>0.000000e+00</td>
      <td>1992.054617</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>22.084803</td>
      <td>1.519178</td>
      <td>4.240540</td>
      <td>2.059257</td>
      <td>0.772653</td>
      <td>0.938894</td>
      <td>4.307807e-209</td>
      <td>559.137865</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados2</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;resultados2.pkl&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos2.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">resultados_graficos2</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos2.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">resultados_graficos2_cargado</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos2</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8fa8f443da4ca8c3feb64e32845b42685ee499f4f31cf854bec38f83a086c66e.png" src="_images/8fa8f443da4ca8c3feb64e32845b42685ee499f4f31cf854bec38f83a086c66e.png" />
<img alt="_images/c3b2389ae1cbf5ba728ed3049c21471737f426c582c1c2c0151bc143baf98931.png" src="_images/c3b2389ae1cbf5ba728ed3049c21471737f426c582c1c2c0151bc143baf98931.png" />
<img alt="_images/2bb9bbda648a603454de2ec970180674b7f632af866ddda35caafcb7b27fe002.png" src="_images/2bb9bbda648a603454de2ec970180674b7f632af866ddda35caafcb7b27fe002.png" />
<img alt="_images/0b0ef2b5b9f6e57547f17db0d572272040b38aa9a3a5f0426dc01911c3f7673a.png" src="_images/0b0ef2b5b9f6e57547f17db0d572272040b38aa9a3a5f0426dc01911c3f7673a.png" />
<img alt="_images/8b42308f1d8277ae17af15710c047067a208ae43231ce731fbb359c89f837e5f.png" src="_images/8b42308f1d8277ae17af15710c047067a208ae43231ce731fbb359c89f837e5f.png" />
<img alt="_images/669fd18cc535461eb786c8d1b69dd820249e9343b69b15dc847e5a08dd64ee01.png" src="_images/669fd18cc535461eb786c8d1b69dd820249e9343b69b15dc847e5a08dd64ee01.png" />
<img alt="_images/36606019f41cf15acb37549718c93bb0da8dc52c612f1a1d51c9babd5820dcee.png" src="_images/36606019f41cf15acb37549718c93bb0da8dc52c612f1a1d51c9babd5820dcee.png" />
<img alt="_images/7580c890bd328691f69ee5c2924fb171c7f3e66ef19b4f8612e09a516304f970.png" src="_images/7580c890bd328691f69ee5c2924fb171c7f3e66ef19b4f8612e09a516304f970.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos2</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1680d77898ebcdf0652f29f219f64d704cc16ddff37aaf9a31109263f4b7af78.png" src="_images/1680d77898ebcdf0652f29f219f64d704cc16ddff37aaf9a31109263f4b7af78.png" />
<img alt="_images/4260d05b8c13d097c2274f02663f0a2aa4972a2fa37a8cfdff70660981f72e2b.png" src="_images/4260d05b8c13d097c2274f02663f0a2aa4972a2fa37a8cfdff70660981f72e2b.png" />
<img alt="_images/d028c32dba589373ec783c227b42105cf772f71bd5f8ce0dcff42dcf10909270.png" src="_images/d028c32dba589373ec783c227b42105cf772f71bd5f8ce0dcff42dcf10909270.png" />
<img alt="_images/192fe49909cfe71e7df832123f2fdb9b82f740da631de2c2819b78df60bd1e3c.png" src="_images/192fe49909cfe71e7df832123f2fdb9b82f740da631de2c2819b78df60bd1e3c.png" />
<img alt="_images/57a9faf1aec49857300e4d917f2710fcfaf237bc9958dc452b4c1bf2904f14c5.png" src="_images/57a9faf1aec49857300e4d917f2710fcfaf237bc9958dc452b4c1bf2904f14c5.png" />
<img alt="_images/8f3b53808a4bf92770e524a005b0f7104b375f45d396f4d577c92ef5a00edad6.png" src="_images/8f3b53808a4bf92770e524a005b0f7104b375f45d396f4d577c92ef5a00edad6.png" />
<img alt="_images/c023bbecfb95db01a4af7792c04af1c8374801eae1fac9b0233e75a34783a4e4.png" src="_images/c023bbecfb95db01a4af7792c04af1c8374801eae1fac9b0233e75a34783a4e4.png" />
<img alt="_images/16360a6bc00a17bd922a93fa20aa14f20d4c5f61faf6fe0bcbffbe6b1d7e56e2.png" src="_images/16360a6bc00a17bd922a93fa20aa14f20d4c5f61faf6fe0bcbffbe6b1d7e56e2.png" />
</div>
</div>
<section id="id2">
<h3><strong>Interpretación de los resultados</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Los resultados de los modelos aplicados para predecir la <strong>velocidad del viento a 100 metros</strong> en el <strong>Sensor 2 (Sureste)</strong> ofrecen un análisis detallado del desempeño de cada enfoque. En este caso, el <strong>XGBoost Regressor</strong> nuevamente demuestra ser el modelo más efectivo, alcanzando un <strong>R² = 0.8945</strong>, lo que implica que explica el 89.45% de la variabilidad de los datos, acompañado de un <strong>RMSE = 1.4021</strong> y un <strong>MAPE = 11.6424%</strong>, destacándose como el modelo con mayor precisión en la predicción.</p>
<p>Otros modelos no lineales, como <strong>Random Forest Regressor</strong> (<strong>R² = 0.8903</strong>) y <strong>Decision Tree Regressor</strong> (<strong>R² = 0.8041</strong>), también muestran un buen desempeño, aunque con un leve aumento en los errores de predicción respecto al modelo XGBoost. En contraste, los modelos lineales como <strong>Ridge</strong>, <strong>Lasso</strong>, y <strong>Linear Regression</strong> presentan valores de <strong>R² = 0.542</strong>, indicando que no capturan adecuadamente las complejidades presentes en las relaciones entre las variables.</p>
<p>Al analizar los residuos, las pruebas estadísticas arrojan resultados consistentes con la presencia de datos atípicos. El <strong>p-value de Jarque-Bera</strong>, con valores extremadamente bajos, confirma que los residuos no siguen una distribución normal, a pesar de que las gráficas de distribución visualmente sugieran lo contrario. Esto es atribuible a las características propias de los datos meteorológicos, donde eventos extremos son comunes y no fueron imputados para mantener la integridad del conjunto de datos. Por su parte, los altos valores del <strong>p-value de Ljung-Box</strong> indican que no existe una autocorrelación significativa en los residuos, validando que los modelos capturan correctamente las relaciones temporales sin introducir sesgos.</p>
<p>En conclusión, para este caso del <strong>Sensor 2 (Sureste)</strong>, el <strong>XGBoost Regressor</strong> se posiciona como la mejor opción para capturar la variabilidad y complejidad de los datos, mientras que los modelos lineales son menos recomendables debido a sus limitaciones para explicar las relaciones no lineales inherentes a las variables meteorológicas. Nótese que los resultados son similares con los obtenidos en la velocidad del viento a 100 metros en el sensor 1.</p>
</section>
</section>
<section id="modelo-3-wind-speed-80-metros-sensor-1">
<h2><strong>Modelo 3: Wind speed 80 metros (Sensor 1)</strong><a class="headerlink" href="#modelo-3-wind-speed-80-metros-sensor-1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X3</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento100m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos3</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span><span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span><span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span> <span class="n">resultados_graficos3</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados3</span><span class="p">,</span><span class="n">resultados_graficos3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados3</span><span class="p">)</span>
<span class="n">resultados3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R²</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
      <th>Tiempo de ejecución (s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN Regressor</td>
      <td>17.977263</td>
      <td>1.293825</td>
      <td>3.323768</td>
      <td>1.823120</td>
      <td>0.811731</td>
      <td>0.950805</td>
      <td>0.000000e+00</td>
      <td>3.381298</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>31.786477</td>
      <td>2.247559</td>
      <td>8.091899</td>
      <td>2.844626</td>
      <td>0.541650</td>
      <td>0.671737</td>
      <td>9.738547e-61</td>
      <td>0.255511</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>31.779554</td>
      <td>2.248289</td>
      <td>8.093561</td>
      <td>2.844918</td>
      <td>0.541556</td>
      <td>0.670560</td>
      <td>5.825831e-60</td>
      <td>0.345939</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>31.777409</td>
      <td>2.248286</td>
      <td>8.093641</td>
      <td>2.844933</td>
      <td>0.541551</td>
      <td>0.670594</td>
      <td>5.926368e-60</td>
      <td>0.002099</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree Regressor</td>
      <td>15.357703</td>
      <td>1.261490</td>
      <td>3.514775</td>
      <td>1.874773</td>
      <td>0.800912</td>
      <td>0.266846</td>
      <td>0.000000e+00</td>
      <td>307.217874</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest Regressor</td>
      <td>12.677809</td>
      <td>0.991537</td>
      <td>1.977538</td>
      <td>1.406250</td>
      <td>0.887986</td>
      <td>0.810194</td>
      <td>0.000000e+00</td>
      <td>630.311983</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost Regressor</td>
      <td>12.131289</td>
      <td>0.958473</td>
      <td>1.942430</td>
      <td>1.393711</td>
      <td>0.889975</td>
      <td>0.604302</td>
      <td>0.000000e+00</td>
      <td>2121.849303</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>22.246015</td>
      <td>1.480558</td>
      <td>4.023526</td>
      <td>2.005873</td>
      <td>0.772095</td>
      <td>0.792934</td>
      <td>2.234988e-269</td>
      <td>833.756794</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados3</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;resultados3.pkl&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos3.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">resultados_graficos3</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos3.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">resultados_graficos3_cargado</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos3</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0d24889f2f5c4bb9cd4ab16cd133039a5bb40c7babec9b12f26c29090c479b7c.png" src="_images/0d24889f2f5c4bb9cd4ab16cd133039a5bb40c7babec9b12f26c29090c479b7c.png" />
<img alt="_images/977399819b768e68f6077d9649baebca17912a5d6ee19115ecce711a259fdbdc.png" src="_images/977399819b768e68f6077d9649baebca17912a5d6ee19115ecce711a259fdbdc.png" />
<img alt="_images/416607c63ca27d95be00941de569cf7570ccb9f08e1aee5e9ed59bfb9d2e9580.png" src="_images/416607c63ca27d95be00941de569cf7570ccb9f08e1aee5e9ed59bfb9d2e9580.png" />
<img alt="_images/c8cb3d0629835596f563fec751bbc2d5e694f11e54c7fa4ae7300eeb81d61a9a.png" src="_images/c8cb3d0629835596f563fec751bbc2d5e694f11e54c7fa4ae7300eeb81d61a9a.png" />
<img alt="_images/4c991ecabb7bde8d90b0e6db997daa0e34d4c3be8ada6c2471ef13b8155db34e.png" src="_images/4c991ecabb7bde8d90b0e6db997daa0e34d4c3be8ada6c2471ef13b8155db34e.png" />
<img alt="_images/cf214a2e44617555b9f2641ef6060b7e8703e735b03ce72491fbeb82980faf7e.png" src="_images/cf214a2e44617555b9f2641ef6060b7e8703e735b03ce72491fbeb82980faf7e.png" />
<img alt="_images/cbdbec35d3c021e67ca7c9571c0752f4d1cb9c11da8e0f7d67c6a3c478ffb5a8.png" src="_images/cbdbec35d3c021e67ca7c9571c0752f4d1cb9c11da8e0f7d67c6a3c478ffb5a8.png" />
<img alt="_images/f296216e6ba3a96573ee47ec32c6a42d53d5f5ed778f655e8a05e4c2b1d496ca.png" src="_images/f296216e6ba3a96573ee47ec32c6a42d53d5f5ed778f655e8a05e4c2b1d496ca.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos3</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7e76d23419af1c6a82007d60e158b5312350dfd13d1478b1b597f59e8a699009.png" src="_images/7e76d23419af1c6a82007d60e158b5312350dfd13d1478b1b597f59e8a699009.png" />
<img alt="_images/ba0af6c865d7c8ba04519ae582c1a02262354f4a09aadf7c8a5887ac1d1995f1.png" src="_images/ba0af6c865d7c8ba04519ae582c1a02262354f4a09aadf7c8a5887ac1d1995f1.png" />
<img alt="_images/34813da75ff1bf570cfabf386fb64e9b57f84a65704244f8ef927cbea6b63370.png" src="_images/34813da75ff1bf570cfabf386fb64e9b57f84a65704244f8ef927cbea6b63370.png" />
<img alt="_images/7f384304d44ad39b94b13d7a427422d1fa196cfa75aab5c006e0eab851c63f0a.png" src="_images/7f384304d44ad39b94b13d7a427422d1fa196cfa75aab5c006e0eab851c63f0a.png" />
<img alt="_images/310401de1b1d81dd2ba345af2f7918b21d7d24a94440a24796def25c471fd08f.png" src="_images/310401de1b1d81dd2ba345af2f7918b21d7d24a94440a24796def25c471fd08f.png" />
<img alt="_images/ae2d9d93390042c1c8acb65e3d16f643e3f7ba90bb79cc9a38c90bc30ee5f0a3.png" src="_images/ae2d9d93390042c1c8acb65e3d16f643e3f7ba90bb79cc9a38c90bc30ee5f0a3.png" />
<img alt="_images/20fd1fcd51fc49c546622c56de77dd87884f1e622a7258ec53e97ea7c1b37181.png" src="_images/20fd1fcd51fc49c546622c56de77dd87884f1e622a7258ec53e97ea7c1b37181.png" />
<img alt="_images/b99750b2a9b528d2f9b800952cfb4d801bced4b1fc5f9f1ced329defbbe52a72.png" src="_images/b99750b2a9b528d2f9b800952cfb4d801bced4b1fc5f9f1ced329defbbe52a72.png" />
</div>
</div>
<section id="id3">
<h3><strong>Interpretación de los resultados</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Para el caso de la <strong>velocidad del viento a 80 metros</strong> medida por el <strong>Sensor 1 (NW)</strong>, los resultados muestran que el <strong>XGBoost Regressor</strong> es nuevamente el modelo con el mejor desempeño. Este logra un <strong>R² = 0.8899</strong>, lo que implica que explica el 88.99% de la variabilidad en los datos. Además, tiene un <strong>RMSE = 1.3937</strong> y un <strong>MAPE = 12.1312%</strong>, confirmando su capacidad para realizar predicciones precisas.</p>
<p>En segundo lugar, el <strong>Random Forest Regressor</strong> también ofrece un desempeño destacado con un <strong>R² = 0.8879</strong>, acompañado de un <strong>RMSE = 1.4062</strong>, aunque con un tiempo de ejecución mayor en comparación con otros modelos lineales. Por otro lado, los modelos lineales como <strong>Ridge</strong>, <strong>Lasso</strong>, y <strong>Linear Regression</strong> presentan valores de <strong>R² cercanos a 0.54</strong>, lo que indica que no capturan adecuadamente las relaciones complejas entre las variables meteorológicas.</p>
<p>Al analizar los residuos, las pruebas estadísticas revelan que el <strong>p-value de Jarque-Bera</strong> es extremadamente bajo, lo que confirma que los residuos no siguen una distribución normal. Esto, a pesar de que las gráficas de los residuos puedan sugerir lo contrario, es atribuible a la presencia de valores atípicos frecuentes en las variables meteorológicas. En cuanto a la independencia de los residuos, los altos valores del <strong>p-value de Ljung-Box</strong> indican que no hay autocorrelación significativa en los residuos de los modelos, validando su ajuste.</p>
<p>Un aspecto relevante identificado en las gráficas de predicción es un posible sobreajuste en los modelos <strong>K-NN</strong>, <strong>Random Forest</strong>, y <strong>XGBoost</strong>. Esto se evidencia por una menor generalización al conjunto de test comparado con el entrenamiento. Este sobreajuste puede deberse al alto nivel de complejidad y flexibilidad de estos modelos, que los lleva a ajustar no solo la señal, sino también el ruido presente en los datos. Sin embargo, este comportamiento es común en problemas donde las variables presentan gran variabilidad y una estructura compleja.</p>
<p>En términos de eficiencia computacional, el modelo <strong>XGBoost</strong> tiene un tiempo de ejecución significativamente alto (<strong>2121.85 segundos</strong>), en contraste con modelos lineales como <strong>Ridge</strong> y <strong>Linear Regression</strong>, que ejecutan en tiempos mínimos pero a costa de una menor capacidad predictiva.</p>
<p>En resumen, para esta configuración del <strong>Sensor 1 a 80 metros</strong>, aunque los modelos no lineales muestran ligeros indicios de sobreajuste, su capacidad para capturar las relaciones complejas en los datos meteorológicos los posiciona como las opciones más adecuadas.</p>
</section>
</section>
<section id="modelo-4-wind-speed-80-metros-sensor-2">
<h2><strong>Modelo 4: Wind speed 80 metros (Sensor 2)</strong><a class="headerlink" href="#modelo-4-wind-speed-80-metros-sensor-2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X4</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento100m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento60m&#39;</span><span class="p">])</span>
<span class="n">y4</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X4</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados4</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos4</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados4</span><span class="p">,</span> <span class="n">resultados_graficos4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados4</span><span class="p">)</span>
<span class="n">resultados4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R²</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
      <th>Tiempo de ejecución (s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN Regressor</td>
      <td>17.924334</td>
      <td>1.292000</td>
      <td>3.315724</td>
      <td>1.820913</td>
      <td>0.811322</td>
      <td>0.954135</td>
      <td>0.000000e+00</td>
      <td>3.661639</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>31.565541</td>
      <td>2.238382</td>
      <td>8.034803</td>
      <td>2.834573</td>
      <td>0.542787</td>
      <td>0.677842</td>
      <td>1.271009e-61</td>
      <td>0.272501</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>31.558762</td>
      <td>2.239107</td>
      <td>8.036467</td>
      <td>2.834866</td>
      <td>0.542692</td>
      <td>0.676661</td>
      <td>7.890101e-61</td>
      <td>0.334058</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>31.556736</td>
      <td>2.239106</td>
      <td>8.036552</td>
      <td>2.834881</td>
      <td>0.542687</td>
      <td>0.676705</td>
      <td>8.028344e-61</td>
      <td>0.003003</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree Regressor</td>
      <td>15.322764</td>
      <td>1.283045</td>
      <td>3.500257</td>
      <td>1.870897</td>
      <td>0.800821</td>
      <td>0.657102</td>
      <td>0.000000e+00</td>
      <td>322.270330</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest Regressor</td>
      <td>12.599720</td>
      <td>0.991317</td>
      <td>1.991380</td>
      <td>1.411162</td>
      <td>0.886682</td>
      <td>0.803388</td>
      <td>0.000000e+00</td>
      <td>627.299740</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost Regressor</td>
      <td>12.089063</td>
      <td>0.955874</td>
      <td>1.944173</td>
      <td>1.394336</td>
      <td>0.889369</td>
      <td>0.622203</td>
      <td>0.000000e+00</td>
      <td>2139.429260</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>22.156858</td>
      <td>1.477805</td>
      <td>4.010497</td>
      <td>2.002623</td>
      <td>0.771786</td>
      <td>0.805015</td>
      <td>1.853042e-270</td>
      <td>572.558218</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados4</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;resultados4.pkl&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos4.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">resultados_graficos4</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos4.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">resultados_graficos4_cargado</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos4</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/baf7fa40dc5019beff939b2551a4742300e7844ca4c578eb76c29c5f9cbbc5f4.png" src="_images/baf7fa40dc5019beff939b2551a4742300e7844ca4c578eb76c29c5f9cbbc5f4.png" />
<img alt="_images/4a8bd985aefcb72347adf438f7408f5e1705bb6bcecbe05dee133a9aa08b0d13.png" src="_images/4a8bd985aefcb72347adf438f7408f5e1705bb6bcecbe05dee133a9aa08b0d13.png" />
<img alt="_images/10e6241a1594bfffe1fb9f251f506e0e32fdfb2bcd0b39cd4a3d45fc8a44beb3.png" src="_images/10e6241a1594bfffe1fb9f251f506e0e32fdfb2bcd0b39cd4a3d45fc8a44beb3.png" />
<img alt="_images/5e1bb81e246e2a431b44f1f6f892dec5d3880b5bd84d154e8f69a5c8bfe45e86.png" src="_images/5e1bb81e246e2a431b44f1f6f892dec5d3880b5bd84d154e8f69a5c8bfe45e86.png" />
<img alt="_images/debe4d42274e1cc816f6791f046ee1f3abebcbd288fd01083746c305c5e944e3.png" src="_images/debe4d42274e1cc816f6791f046ee1f3abebcbd288fd01083746c305c5e944e3.png" />
<img alt="_images/2032fcfc4131aa07ea0520c8d977a987f1e94de6f46c891628f2d0b9a775030a.png" src="_images/2032fcfc4131aa07ea0520c8d977a987f1e94de6f46c891628f2d0b9a775030a.png" />
<img alt="_images/3933811c51e1dd5e2e7c95388571781b1d5f13273bbde19d055c481f4db7533f.png" src="_images/3933811c51e1dd5e2e7c95388571781b1d5f13273bbde19d055c481f4db7533f.png" />
<img alt="_images/c49b60cc04b79611d89f80b9650c8f55e321b404d429819d87774eb9cd88ee0c.png" src="_images/c49b60cc04b79611d89f80b9650c8f55e321b404d429819d87774eb9cd88ee0c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos4</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b7df6c8e6f784f26339abccb27f8bc0805b395206bbdd56a71d3cd67065b5d75.png" src="_images/b7df6c8e6f784f26339abccb27f8bc0805b395206bbdd56a71d3cd67065b5d75.png" />
<img alt="_images/e31b795fd1db6471a302278c4baa52594c193046e91120059508e6e90525fdf6.png" src="_images/e31b795fd1db6471a302278c4baa52594c193046e91120059508e6e90525fdf6.png" />
<img alt="_images/a0f0d894a5823be62fa8a5b8f9688324accba25685186d47e4c7889ccc57974b.png" src="_images/a0f0d894a5823be62fa8a5b8f9688324accba25685186d47e4c7889ccc57974b.png" />
<img alt="_images/4fdc32f2f06aab6c6817a3fa383d09c0bd79d7468aca7ee0c595279840237b91.png" src="_images/4fdc32f2f06aab6c6817a3fa383d09c0bd79d7468aca7ee0c595279840237b91.png" />
<img alt="_images/ff6bf5458196a229401743bfe69da2cbb5bf315cf878035b808c491fa77f2c14.png" src="_images/ff6bf5458196a229401743bfe69da2cbb5bf315cf878035b808c491fa77f2c14.png" />
<img alt="_images/229bc7413d02b4c4c5b385a1a69db438001e0b2cc7cdfcf4df3ed302f92406da.png" src="_images/229bc7413d02b4c4c5b385a1a69db438001e0b2cc7cdfcf4df3ed302f92406da.png" />
<img alt="_images/61e558f5aded06d4f56cc56acae898b9beaf405a645d9c86721de18d9afeb0c6.png" src="_images/61e558f5aded06d4f56cc56acae898b9beaf405a645d9c86721de18d9afeb0c6.png" />
<img alt="_images/3040386807fb3bd87ea61fbb10581c30d8f3cac3ecd378241f5c84806fc537ad.png" src="_images/3040386807fb3bd87ea61fbb10581c30d8f3cac3ecd378241f5c84806fc537ad.png" />
</div>
</div>
<section id="id4">
<h3><strong>Interpretación de los resultados</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Para la <strong>velocidad del viento a 80 metros</strong>, medida por el <strong>Sensor 2 (SE)</strong>, el modelo <strong>XGBoost Regressor</strong> destaca como el más efectivo, logrando un <strong>R² = 0.8894</strong>, lo que indica que explica el 88.94% de la variabilidad en los datos. Además, con un <strong>RMSE = 1.3943</strong> y un <strong>MAPE = 12.08%</strong>, demuestra ser superior al <strong>Random Forest Regressor</strong>, que obtuvo un <strong>R² = 0.8866</strong> y un <strong>RMSE = 1.4111</strong>. En contraste, los modelos lineales como <strong>Ridge</strong>, <strong>Lasso</strong> y <strong>Linear Regression</strong> presentan un desempeño limitado, con valores de <strong>R² cercanos a 0.54</strong>, mostrando dificultades para capturar las relaciones no lineales entre las variables meteorológicas. Por otro lado, el <strong>Decision Tree Regressor</strong> presenta un desempeño intermedio, con un <strong>R² = 0.8008</strong>, pero su naturaleza jerárquica limita su capacidad de generalización. Los análisis de residuos revelan que, aunque las gráficas sugieren normalidad, las pruebas de <strong>Jarque-Bera</strong> confirman que los residuos no siguen una distribución normal, probablemente debido a datos atípicos inherentes a las variables meteorológicas, los cuales no se imputaron por su relevancia. Además, la prueba de <strong>Ljung-Box</strong> indica ausencia de autocorrelación significativa en los residuos, lo que valida los modelos seleccionados. Sin embargo, en las gráficas de predicción se observa posible sobreajuste en modelos como <strong>XGBoost</strong>, <strong>Random Forest</strong> y <strong>K-NN</strong>, lo cual puede atribuirse a su complejidad al intentar capturar patrones específicos. En cuanto a tiempos de ejecución, los modelos lineales son los más eficientes, destacándose <strong>Ridge</strong> y <strong>Linear Regression</strong> con tiempos menores a un segundo, mientras que <strong>XGBoost</strong> es el más costoso computacionalmente, con <strong>2139.43 segundos</strong>. En conclusión, <strong>XGBoost Regressor</strong> se posiciona como el modelo más adecuado, destacándose en precisión y capacidad predictiva, a pesar de su mayor costo computacional.</p>
</section>
</section>
<section id="modelo-5-wind-speed-60-metros">
<h2><strong>Modelo 5: Wind speed 60 metros</strong><a class="headerlink" href="#modelo-5-wind-speed-60-metros" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X5</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento100m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_1&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento80m_2&#39;</span><span class="p">,</span> <span class="s1">&#39;VelViento60m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento80m&#39;</span><span class="p">,</span> <span class="s1">&#39;DirViento100m&#39;</span><span class="p">])</span>
<span class="n">y5</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;VelViento60m&#39;</span><span class="p">]</span>


<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X5</span><span class="p">,</span> <span class="n">y5</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">resultados5</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">resultados_graficos5</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_knn</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span><span class="n">resultados_graficos5</span> <span class="p">)</span>
<span class="n">evaluate_ridge</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_lasso</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_linear</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_forest</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_xgboost</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span> <span class="n">resultados_graficos5</span><span class="p">)</span>
<span class="n">evaluate_svr</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">resultados5</span><span class="p">,</span><span class="n">resultados_graficos5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados5</span><span class="p">)</span> 
<span class="n">resultados5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R²</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
      <th>Tiempo de ejecución (s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN Regressor</td>
      <td>16.918266</td>
      <td>1.244779</td>
      <td>3.060801</td>
      <td>1.749514</td>
      <td>0.812379</td>
      <td>0.710789</td>
      <td>0.000000e+00</td>
      <td>3.452404</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ridge Regression</td>
      <td>30.936798</td>
      <td>2.163415</td>
      <td>7.467630</td>
      <td>2.732696</td>
      <td>0.542249</td>
      <td>0.701908</td>
      <td>1.476396e-45</td>
      <td>0.242612</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lasso Regression</td>
      <td>30.976198</td>
      <td>2.161207</td>
      <td>7.462717</td>
      <td>2.731797</td>
      <td>0.542550</td>
      <td>0.704426</td>
      <td>9.573643e-48</td>
      <td>0.298123</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear Regression</td>
      <td>30.927257</td>
      <td>2.164199</td>
      <td>7.469554</td>
      <td>2.733048</td>
      <td>0.542131</td>
      <td>0.700981</td>
      <td>7.157022e-45</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Decision Tree Regressor</td>
      <td>14.962153</td>
      <td>1.277188</td>
      <td>3.318428</td>
      <td>1.821655</td>
      <td>0.796587</td>
      <td>0.346885</td>
      <td>0.000000e+00</td>
      <td>396.606344</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest Regressor</td>
      <td>11.660752</td>
      <td>0.957866</td>
      <td>1.767702</td>
      <td>1.329550</td>
      <td>0.891643</td>
      <td>0.826495</td>
      <td>0.000000e+00</td>
      <td>777.434427</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost Regressor</td>
      <td>11.301538</td>
      <td>0.926977</td>
      <td>1.741365</td>
      <td>1.319608</td>
      <td>0.893258</td>
      <td>0.537477</td>
      <td>0.000000e+00</td>
      <td>2616.222193</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVR</td>
      <td>21.464075</td>
      <td>1.426849</td>
      <td>3.712218</td>
      <td>1.926712</td>
      <td>0.772448</td>
      <td>0.651853</td>
      <td>1.109584e-165</td>
      <td>867.076097</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados5</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;resultados5.pkl&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos5.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">resultados_graficos5</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resultados_graficos5.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">resultados_graficos5_cargado</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos5</span><span class="p">:</span>
    <span class="c1"># Gráfica de predicciones</span>
    <span class="n">grafica</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_train_pred&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">],</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;y_test_pred&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f372199b552bbfa9e005c2f70df106fce1a29f849ee9f06345dc772fb57f1c9f.png" src="_images/f372199b552bbfa9e005c2f70df106fce1a29f849ee9f06345dc772fb57f1c9f.png" />
<img alt="_images/34ba476b4e3329ef4ffa13821356ffd921db62d05248ee0e0434ec5bac912d1d.png" src="_images/34ba476b4e3329ef4ffa13821356ffd921db62d05248ee0e0434ec5bac912d1d.png" />
<img alt="_images/cf75e6d7d991cc06dd9bc6c205051c60a9477b9955ce4ecd095e0627f64a4637.png" src="_images/cf75e6d7d991cc06dd9bc6c205051c60a9477b9955ce4ecd095e0627f64a4637.png" />
<img alt="_images/8dcd6e2144f14a91d27adad323bc18c7adda78b51bf358caf039303934a74745.png" src="_images/8dcd6e2144f14a91d27adad323bc18c7adda78b51bf358caf039303934a74745.png" />
<img alt="_images/2bbab5c8e92cd09df691f469d6d10a9d6e3ce3bafa6dced610167bf688f7655a.png" src="_images/2bbab5c8e92cd09df691f469d6d10a9d6e3ce3bafa6dced610167bf688f7655a.png" />
<img alt="_images/195ae65398aeb98764055b2fb86aac259fe54a2de4adb2cc86896a1563390de4.png" src="_images/195ae65398aeb98764055b2fb86aac259fe54a2de4adb2cc86896a1563390de4.png" />
<img alt="_images/c12f6e854b6d7fa058be46c2c36b99a346ce6311a5dfd8a380985864cf2132e4.png" src="_images/c12f6e854b6d7fa058be46c2c36b99a346ce6311a5dfd8a380985864cf2132e4.png" />
<img alt="_images/674c27da4bd610f77a737f003a201de9e04b26046b729bd493a57feeeb04a68f.png" src="_images/674c27da4bd610f77a737f003a201de9e04b26046b729bd493a57feeeb04a68f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_graficos5</span><span class="p">:</span>
    <span class="n">grafica_residuos</span><span class="p">(</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;nombre_modelo&#39;</span><span class="p">],</span>
        <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;residuos&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d7b68d92d759dfcdd2725aeb682087704f1b1a73ca9a97f3363ec19d1eb7f2ec.png" src="_images/d7b68d92d759dfcdd2725aeb682087704f1b1a73ca9a97f3363ec19d1eb7f2ec.png" />
<img alt="_images/c2eea0519aac55e610b0b06bbaa057ab071abe35edb3c58f993312de6f16230d.png" src="_images/c2eea0519aac55e610b0b06bbaa057ab071abe35edb3c58f993312de6f16230d.png" />
<img alt="_images/3db3cea4ea51730488a349df87f20e7ab2a8ced164dee279a72957af70dcd502.png" src="_images/3db3cea4ea51730488a349df87f20e7ab2a8ced164dee279a72957af70dcd502.png" />
<img alt="_images/200844533edff815cde37a9fa954bcbccc39e32344c9026214d7d903f40764fb.png" src="_images/200844533edff815cde37a9fa954bcbccc39e32344c9026214d7d903f40764fb.png" />
<img alt="_images/6865717b2baf8f7421ffdedbe34fbf26d77604855ff1b84834828161b15d2bf3.png" src="_images/6865717b2baf8f7421ffdedbe34fbf26d77604855ff1b84834828161b15d2bf3.png" />
<img alt="_images/6d9ed12675f8b988b8dc4b0078d3a222fd1815fde9ddd74d7d51f9b047a4992f.png" src="_images/6d9ed12675f8b988b8dc4b0078d3a222fd1815fde9ddd74d7d51f9b047a4992f.png" />
<img alt="_images/8df266dd1c2359640736317f81ae850f0511e929f0d194947f371360da467f37.png" src="_images/8df266dd1c2359640736317f81ae850f0511e929f0d194947f371360da467f37.png" />
<img alt="_images/3ddcaae56a89c96802ef5acde24b24c22005cea5076f282acc834c0de792551d.png" src="_images/3ddcaae56a89c96802ef5acde24b24c22005cea5076f282acc834c0de792551d.png" />
</div>
</div>
<section id="id5">
<h3><strong>Interpretación de los resultados</strong><a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>Para la <strong>velocidad del viento a 60 metros</strong>, los modelos <strong>XGBoost Regressor</strong> y <strong>Random Forest Regressor</strong> se destacan con los mejores resultados, alcanzando <strong>R² = 0.8938</strong> y <strong>0.8904</strong>, respectivamente, y bajos valores de <strong>RMSE</strong> (<strong>1.3161</strong> y <strong>1.3370</strong>). Los modelos lineales (<strong>Ridge</strong>, <strong>Lasso</strong> y <strong>Linear Regression</strong>) muestran menor desempeño con <strong>R² ≈ 0.542</strong>, reflejando limitaciones en capturar la complejidad de los datos.</p>
<p>Los residuos no siguen una distribución normal, según la prueba <strong>Jarque-Bera</strong>, debido a datos atípicos inherentes a la dinámica del viento, pero no presentan autocorrelación significativa según <strong>Ljung-Box</strong>. Aunque <strong>K-NN</strong> presenta cierto sobreajuste (<strong>R² = 0.8123</strong>), <strong>XGBoost</strong> y <strong>Random Forest</strong> se consolidan como las mejores opciones por su balance entre precisión y ajuste, pese a sus mayores tiempos de ejecución.</p>
</section>
</section>
<section id="interpretacion-general">
<h2><strong>Interpretación general</strong><a class="headerlink" href="#interpretacion-general" title="Link to this heading">#</a></h2>
<p>En general, al evaluar los modelos predictivos aplicados a las velocidades del viento en diferentes alturas y sensores, se observa que <strong>XGBoost Regressor</strong> y <strong>Random Forest Regressor</strong> consistentemente muestran el mejor desempeño en términos de precisión y capacidad de ajuste. Estos modelos obtienen valores altos de <strong>R²</strong> (cercanos a 0.89 en la mayoría de los casos) y bajos <strong>RMSE</strong>, lo que los posiciona como las opciones más adecuadas para capturar las complejidades de las variables meteorológicas.</p>
<p>Por otro lado, los modelos lineales (<strong>Ridge</strong>, <strong>Lasso</strong>, y <strong>Linear Regression</strong>) tienen un desempeño limitado, con valores de <strong>R²</strong> significativamente más bajos (≈ 0.54), indicando que no logran modelar las relaciones no lineales presentes en los datos. Modelos como <strong>K-NN</strong> muestran sobreajuste en algunos escenarios debido a su alta sensibilidad a los datos de entrenamiento, aunque su desempeño general es competitivo.</p>
<p>En cuanto al análisis de los residuos, las pruebas <strong>Jarque-Bera</strong> indican que no siguen una distribución normal debido a la presencia de datos atípicos inherentes a las mediciones meteorológicas reales. Sin embargo, los valores de <strong>Ljung-Box p-value</strong> confirman que no hay autocorrelación significativa en los residuos, asegurando la independencia de los errores.</p>
<p>En conclusión, aunque el tiempo de ejecución es considerablemente mayor para <strong>XGBoost</strong> y <strong>Random Forest</strong>, su precisión y capacidad para manejar las relaciones complejas entre variables meteorológicas los convierten en las mejores alternativas para modelar la velocidad del viento en las diferentes alturas y sensores analizados.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="eda.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Análisis Exploratorio de Datos (EDA)</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="original.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Propuesta de modelo original</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos"><strong>Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracteristicas-principales-de-la-base-de-datos"><strong>Características principales de la base de datos</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Modelos de regresión</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-evaluacion"><strong>Métricas de evaluación</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-realizar-las-graficas"><strong>Métodos para realizar las gráficas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-los-modelos-de-regresion"><strong>Métodos para los modelos de regresión</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-regressor"><strong>KNN Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression"><strong>Ridge Regression</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression"><strong>Lasso Regression</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression"><strong>Linear Regression</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree-regressor"><strong>Decision Tree Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-regressor"><strong>Random Forest Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-regressor"><strong>XGBoost Regressor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svr-support-vector-regression"><strong>SVR (Support Vector Regression)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aspectos-importantes"><strong>Aspectos importantes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-1-wind-speed-100-metros-sensor-1"><strong>Modelo 1: Wind speed 100 metros (Sensor 1)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-2-wind-speed-100-metros-sensor-2"><strong>Modelo 2: Wind speed 100 metros (Sensor 2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-3-wind-speed-80-metros-sensor-1"><strong>Modelo 3: Wind speed 80 metros (Sensor 1)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-4-wind-speed-80-metros-sensor-2"><strong>Modelo 4: Wind speed 80 metros (Sensor 2)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-5-wind-speed-60-metros"><strong>Modelo 5: Wind speed 60 metros</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Interpretación de los resultados</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-general"><strong>Interpretación general</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kanery Marcela Camargo Rodríguez y Emanuel de Jesús Carbonell Naranjo.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>